
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://yourusername.github.io/DNAbyte/reference/">
      
      
        <link rel="prev" href="../concepts/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Reference - DNAbyte Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="DNAbyte Documentation" class="md-header__button md-logo" aria-label="DNAbyte Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DNAbyte Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Eko-Refugium/DNAbyte" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Eko-Refugium/DNAbyte
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DNAbyte Documentation" class="md-nav__button md-logo" aria-label="DNAbyte Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    DNAbyte Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Eko-Refugium/DNAbyte" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Eko-Refugium/DNAbyte
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../simulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simulation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concepts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-structures" class="md-nav__link">
    <span class="md-ellipsis">
      Data structures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dnads" class="md-nav__link">
    <span class="md-ellipsis">
      DNADS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.DNADS" class="md-nav__link">
    <span class="md-ellipsis">
      DNADS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.DNADS.binarize" class="md-nav__link">
    <span class="md-ellipsis">
      binarize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="binarize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rawdata" class="md-nav__link">
    <span class="md-ellipsis">
      RawData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.RawData" class="md-nav__link">
    <span class="md-ellipsis">
      RawData
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.RawData.init" class="md-nav__link">
    <span class="md-ellipsis">
      init
    </span>
  </a>
  
    <nav class="md-nav" aria-label="init">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#encodeddata" class="md-nav__link">
    <span class="md-ellipsis">
      EncodedData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.EncodedData" class="md-nav__link">
    <span class="md-ellipsis">
      EncodedData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EncodedData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#assembleddata" class="md-nav__link">
    <span class="md-ellipsis">
      AssembledData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.AssembledData" class="md-nav__link">
    <span class="md-ellipsis">
      AssembledData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AssembledData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#storedddata" class="md-nav__link">
    <span class="md-ellipsis">
      StoreddData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.StoredData" class="md-nav__link">
    <span class="md-ellipsis">
      StoredData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StoredData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sequenceddata" class="md-nav__link">
    <span class="md-ellipsis">
      SequencedData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.SequencedData" class="md-nav__link">
    <span class="md-ellipsis">
      SequencedData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SequencedData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#correcteddata" class="md-nav__link">
    <span class="md-ellipsis">
      CorrectedData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.CorrectedData" class="md-nav__link">
    <span class="md-ellipsis">
      CorrectedData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CorrectedData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decodeddata" class="md-nav__link">
    <span class="md-ellipsis">
      DecodedData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.DecodedData" class="md-nav__link">
    <span class="md-ellipsis">
      DecodedData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DecodedData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#restoreddata" class="md-nav__link">
    <span class="md-ellipsis">
      RestoredData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.RestoredData" class="md-nav__link">
    <span class="md-ellipsis">
      RestoredData
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.RestoredData.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#params" class="md-nav__link">
    <span class="md-ellipsis">
      Params
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.params" class="md-nav__link">
    <span class="md-ellipsis">
      params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.params.Params" class="md-nav__link">
    <span class="md-ellipsis">
      Params
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Params">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dnabyte.params.Params.params_range" class="md-nav__link">
    <span class="md-ellipsis">
      params_range
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encode" class="md-nav__link">
    <span class="md-ellipsis">
      Encode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.encode" class="md-nav__link">
    <span class="md-ellipsis">
      encode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.encode.Encode" class="md-nav__link">
    <span class="md-ellipsis">
      Encode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Encode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dnabyte.encode.Encode.decode" class="md-nav__link">
    <span class="md-ellipsis">
      decode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnabyte.encode.Encode.encode" class="md-nav__link">
    <span class="md-ellipsis">
      encode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnabyte.encode.Encode.process" class="md-nav__link">
    <span class="md-ellipsis">
      process
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.assembly" class="md-nav__link">
    <span class="md-ellipsis">
      assembly
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.assembly.SimulateAssembly" class="md-nav__link">
    <span class="md-ellipsis">
      SimulateAssembly
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SimulateAssembly">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dnabyte.assembly.SimulateAssembly.call_function_repeatedly_therory" class="md-nav__link">
    <span class="md-ellipsis">
      call_function_repeatedly_therory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnabyte.assembly.SimulateAssembly.nest_list" class="md-nav__link">
    <span class="md-ellipsis">
      nest_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnabyte.assembly.SimulateAssembly.print_list_structure" class="md-nav__link">
    <span class="md-ellipsis">
      print_list_structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnabyte.assembly.SimulateAssembly.recursive_assembly" class="md-nav__link">
    <span class="md-ellipsis">
      recursive_assembly
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.storage" class="md-nav__link">
    <span class="md-ellipsis">
      storage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.storage.SimulateStorage" class="md-nav__link">
    <span class="md-ellipsis">
      SimulateStorage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SimulateStorage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dnabyte.storage.SimulateStorage.simulate" class="md-nav__link">
    <span class="md-ellipsis">
      simulate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.sequencing" class="md-nav__link">
    <span class="md-ellipsis">
      sequencing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.sequencing.SimulateSequencing" class="md-nav__link">
    <span class="md-ellipsis">
      SimulateSequencing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SimulateSequencing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dnabyte.sequencing.SimulateSequencing.simulate" class="md-nav__link">
    <span class="md-ellipsis">
      simulate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-structures" class="md-nav__link">
    <span class="md-ellipsis">
      Data structures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dnads" class="md-nav__link">
    <span class="md-ellipsis">
      DNADS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.DNADS" class="md-nav__link">
    <span class="md-ellipsis">
      DNADS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.DNADS.binarize" class="md-nav__link">
    <span class="md-ellipsis">
      binarize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="binarize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rawdata" class="md-nav__link">
    <span class="md-ellipsis">
      RawData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.RawData" class="md-nav__link">
    <span class="md-ellipsis">
      RawData
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.RawData.init" class="md-nav__link">
    <span class="md-ellipsis">
      init
    </span>
  </a>
  
    <nav class="md-nav" aria-label="init">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#encodeddata" class="md-nav__link">
    <span class="md-ellipsis">
      EncodedData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.EncodedData" class="md-nav__link">
    <span class="md-ellipsis">
      EncodedData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EncodedData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#assembleddata" class="md-nav__link">
    <span class="md-ellipsis">
      AssembledData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.AssembledData" class="md-nav__link">
    <span class="md-ellipsis">
      AssembledData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AssembledData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#storedddata" class="md-nav__link">
    <span class="md-ellipsis">
      StoreddData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.StoredData" class="md-nav__link">
    <span class="md-ellipsis">
      StoredData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StoredData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sequenceddata" class="md-nav__link">
    <span class="md-ellipsis">
      SequencedData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.SequencedData" class="md-nav__link">
    <span class="md-ellipsis">
      SequencedData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SequencedData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#correcteddata" class="md-nav__link">
    <span class="md-ellipsis">
      CorrectedData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.CorrectedData" class="md-nav__link">
    <span class="md-ellipsis">
      CorrectedData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CorrectedData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#decodeddata" class="md-nav__link">
    <span class="md-ellipsis">
      DecodedData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.DecodedData" class="md-nav__link">
    <span class="md-ellipsis">
      DecodedData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DecodedData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#restoreddata" class="md-nav__link">
    <span class="md-ellipsis">
      RestoredData
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.RestoredData" class="md-nav__link">
    <span class="md-ellipsis">
      RestoredData
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.data.RestoredData.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#params" class="md-nav__link">
    <span class="md-ellipsis">
      Params
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.params" class="md-nav__link">
    <span class="md-ellipsis">
      params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.params.Params" class="md-nav__link">
    <span class="md-ellipsis">
      Params
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Params">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dnabyte.params.Params.params_range" class="md-nav__link">
    <span class="md-ellipsis">
      params_range
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#encode" class="md-nav__link">
    <span class="md-ellipsis">
      Encode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.encode" class="md-nav__link">
    <span class="md-ellipsis">
      encode
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.encode.Encode" class="md-nav__link">
    <span class="md-ellipsis">
      Encode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Encode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dnabyte.encode.Encode.decode" class="md-nav__link">
    <span class="md-ellipsis">
      decode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnabyte.encode.Encode.encode" class="md-nav__link">
    <span class="md-ellipsis">
      encode
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnabyte.encode.Encode.process" class="md-nav__link">
    <span class="md-ellipsis">
      process
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.assembly" class="md-nav__link">
    <span class="md-ellipsis">
      assembly
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.assembly.SimulateAssembly" class="md-nav__link">
    <span class="md-ellipsis">
      SimulateAssembly
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SimulateAssembly">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dnabyte.assembly.SimulateAssembly.call_function_repeatedly_therory" class="md-nav__link">
    <span class="md-ellipsis">
      call_function_repeatedly_therory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnabyte.assembly.SimulateAssembly.nest_list" class="md-nav__link">
    <span class="md-ellipsis">
      nest_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnabyte.assembly.SimulateAssembly.print_list_structure" class="md-nav__link">
    <span class="md-ellipsis">
      print_list_structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dnabyte.assembly.SimulateAssembly.recursive_assembly" class="md-nav__link">
    <span class="md-ellipsis">
      recursive_assembly
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.storage" class="md-nav__link">
    <span class="md-ellipsis">
      storage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.storage.SimulateStorage" class="md-nav__link">
    <span class="md-ellipsis">
      SimulateStorage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SimulateStorage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dnabyte.storage.SimulateStorage.simulate" class="md-nav__link">
    <span class="md-ellipsis">
      simulate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.sequencing" class="md-nav__link">
    <span class="md-ellipsis">
      sequencing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnabyte.sequencing.SimulateSequencing" class="md-nav__link">
    <span class="md-ellipsis">
      SimulateSequencing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SimulateSequencing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dnabyte.sequencing.SimulateSequencing.simulate" class="md-nav__link">
    <span class="md-ellipsis">
      simulate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="reference">Reference<a class="headerlink" href="#reference" title="Permanent link">&para;</a></h1>
<h2 id="data-structures">Data structures<a class="headerlink" href="#data-structures" title="Permanent link">&para;</a></h2>
<h3 id="dnads">DNADS<a class="headerlink" href="#dnads" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<a id="dnabyte.data.DNADS"></a>
    <div class="doc doc-contents first">


        <p>DNADS is the base class for all data types in the MI-DNA-DISC project.</p>
<p>It can be instantiated 
 - with a list of absolute paths to files or, alternatively
 - with a path to a folder using the alternative constructor from_folder.</p>
<p>:param file_paths: A list of absolute paths to files.</p>







              <details class="quote">
                <summary>Source code in <code>dnabyte/data.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DNADS</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DNADS is the base class for all data types in the MI-DNA-DISC project.</span>

<span class="sd">    It can be instantiated </span>
<span class="sd">     - with a list of absolute paths to files or, alternatively</span>
<span class="sd">     - with a path to a folder using the alternative constructor from_folder.</span>

<span class="sd">    :param file_paths: A list of absolute paths to files.    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_paths</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">file_paths</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File path </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2"> does not point to an existing file.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="n">file_paths</span>
        <span class="c1">#self.size = self.calculate_total_bytes()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_folder</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">folder_path</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Folder path </span><span class="si">{</span><span class="n">folder_path</span><span class="si">}</span><span class="s2"> does not point to an existing directory.&quot;</span><span class="p">)</span>
        <span class="n">file_paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span> <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)]</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">file_paths</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_total_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">total_bytes</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span><span class="p">:</span>
            <span class="n">total_bytes</span> <span class="o">+=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">total_bytes</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;Type: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="c1">#output += &quot;Bytes:&quot; + str(self.size) + &quot;\n&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;File paths: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">binarize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the files in the DNADS object to a binary sequence.</span>

<span class="sd">        :return: A string of binary data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create a compressed tar archive file</span>
        <span class="n">folder_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">archive_name</span> <span class="o">=</span> <span class="n">folder_path</span> <span class="o">+</span> <span class="s1">&#39;/archive.tar.gz&#39;</span>

        <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">archive_name</span><span class="p">,</span> <span class="s1">&#39;w:gz&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">archive</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span><span class="p">:</span>
                <span class="n">archive</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

        <span class="n">size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">archive_name</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">archive_name</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">binary_data</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">binary_sequence</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">byte</span><span class="p">,</span> <span class="s1">&#39;08b&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">binary_data</span><span class="p">)</span>

        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">archive_name</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">RawData</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">binary_sequence</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">binary_sequence</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="dnabyte.data.DNADS.binarize" class="doc doc-heading">
            <code class=" language-python"><span class="n">binarize</span><span class="p">()</span></code>

<a href="#dnabyte.data.DNADS.binarize" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Converts the files in the DNADS object to a binary sequence.</p>
<p>:return: A string of binary data.</p>


            <details class="quote">
              <summary>Source code in <code>dnabyte/data.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">binarize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the files in the DNADS object to a binary sequence.</span>

<span class="sd">    :return: A string of binary data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a compressed tar archive file</span>
    <span class="n">folder_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">archive_name</span> <span class="o">=</span> <span class="n">folder_path</span> <span class="o">+</span> <span class="s1">&#39;/archive.tar.gz&#39;</span>

    <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">archive_name</span><span class="p">,</span> <span class="s1">&#39;w:gz&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">archive</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span><span class="p">:</span>
            <span class="n">archive</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

    <span class="n">size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">archive_name</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">archive_name</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">binary_data</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">binary_sequence</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">byte</span><span class="p">,</span> <span class="s1">&#39;08b&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">binary_data</span><span class="p">)</span>

    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">archive_name</span><span class="p">)</span>

    <span class="n">obj</span> <span class="o">=</span> <span class="n">RawData</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">binary_sequence</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">binary_sequence</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="rawdata">RawData<a class="headerlink" href="#rawdata" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<a id="dnabyte.data.RawData"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="dnabyte.data.DNADS" href="#dnabyte.data.DNADS">DNADS</a></code></p>


        <p>RawData is a subclass of DNADS.</p>
<p>It consists of a compressed bitstream of the files in the DNADS object. For testing purposes, the RawData object can also directly be created from a bitstream.</p>
<p>:param dnads: A DNADS object.</p>







              <details class="quote">
                <summary>Source code in <code>dnabyte/data.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RawData</span><span class="p">(</span><span class="n">DNADS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    RawData is a subclass of DNADS.</span>

<span class="sd">    It consists of a compressed bitstream of the files in the DNADS object. For testing purposes, the RawData object can also directly be created from a bitstream.</span>

<span class="sd">    :param dnads: A DNADS object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bitstream</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a RawData object from a bitstream.</span>

<span class="sd">        :param bitstream: A string of binary data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">bitstream</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bitstream</span><span class="p">)</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bitstream</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span>  <span class="c1"># Size in bytes</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">instance</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;DATA: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[:</span><span class="mi">50</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="c1"># output = &quot;Type: &quot; + str(type(self)) + &quot;\n&quot;</span>
        <span class="c1"># output += &quot;Bytes:&quot; + str(self.calculate_total_bytes()) + &quot;\n&quot;</span>
        <span class="c1"># output += &quot;DATA: &quot; + str(self.data)[:200] + &quot;...\n&quot;</span>
        <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="dnabyte.data.RawData.init" class="doc doc-heading">
            <code class=" language-python"><span class="n">init</span><span class="p">(</span><span class="n">bitstream</span><span class="p">)</span></code>

<a href="#dnabyte.data.RawData.init" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Creates a RawData object from a bitstream.</p>
<p>:param bitstream: A string of binary data.</p>


            <details class="quote">
              <summary>Source code in <code>dnabyte/data.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bitstream</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a RawData object from a bitstream.</span>

<span class="sd">    :param bitstream: A string of binary data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">instance</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">bitstream</span>
    <span class="n">instance</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bitstream</span><span class="p">)</span>
    <span class="n">instance</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bitstream</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span>  <span class="c1"># Size in bytes</span>
    <span class="n">instance</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">instance</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="encodeddata">EncodedData<a class="headerlink" href="#encodeddata" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<a id="dnabyte.data.EncodedData"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="dnabyte.data.DNADS" href="#dnabyte.data.DNADS">DNADS</a></code></p>


        <p>EncodedData is a subclass of DNADS.</p>
<p>Its main attribute is the data object, which consists of a multi-leveled list. At the highest level, data consists of a list of codewords, there is one list for every codeword in the data object. At the lowest level there are lists of motifs or nucleotides, that are to be hybridised in a single pool. The list structure represents the hierarchical structure of the pooling process. </p>
<p>:param raw_data: A RawData object.
:param encoding_scheme: An EncodingScheme object.</p>







              <details class="quote">
                <summary>Source code in <code>dnabyte/data.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">EncodedData</span><span class="p">(</span><span class="n">DNADS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    EncodedData is a subclass of DNADS.</span>

<span class="sd">    Its main attribute is the data object, which consists of a multi-leveled list. At the highest level, data consists of a list of codewords, there is one list for every codeword in the data object. At the lowest level there are lists of motifs or nucleotides, that are to be hybridised in a single pool. The list structure represents the hierarchical structure of the pooling process. </span>

<span class="sd">    :param raw_data: A RawData object.</span>
<span class="sd">    :param encoding_scheme: An EncodingScheme object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#TODO: make it an actual subclass of DNADS </span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1">#self.file_paths = raw_data.file_paths</span>
        <span class="c1">#self.size = raw_data.size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">raw_data</span>
        <span class="k">if</span> <span class="s2">&quot;file_paths&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;file_paths&#39;</span><span class="p">]</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;DATA: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[:</span><span class="mi">50</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="c1"># output = &quot;Type: &quot; + str(type(self)) + &quot;\n&quot;</span>
        <span class="c1"># #output += &quot;Bytes:&quot; + str(self.calculate_total_bytes()) + &quot;\n&quot;</span>
        <span class="c1"># output += &quot;Number of Codewords : &quot; + str(len(self.data)) + &quot;\n&quot;</span>
        <span class="c1"># output += &quot;DATA: &quot; + str(self.data)[:200] + &quot;...\n&quot;</span>
        <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div><h3 id="assembleddata">AssembledData<a class="headerlink" href="#assembleddata" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<a id="dnabyte.data.AssembledData"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="dnabyte.data.DNADS" href="#dnabyte.data.DNADS">DNADS</a></code></p>


        <p>AssembledData is a subclass of DNADS.</p>
<p>It consists of a list of codewords generated from the list of codewords of the EncodedData object. This step simulates the process of synthesizing DNA from the codewords. In this process the codewords are generated in stochastic number of copies and errors are introduced.</p>
<p>:param encoded_data: An EncodedData object.
:param synthesis_simulator: A SynthesisSimulator object.</p>







              <details class="quote">
                <summary>Source code in <code>dnabyte/data.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AssembledData</span><span class="p">(</span><span class="n">DNADS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    AssembledData is a subclass of DNADS.</span>

<span class="sd">    It consists of a list of codewords generated from the list of codewords of the EncodedData object. This step simulates the process of synthesizing DNA from the codewords. In this process the codewords are generated in stochastic number of copies and errors are introduced.</span>

<span class="sd">    :param encoded_data: An EncodedData object.</span>
<span class="sd">    :param synthesis_simulator: A SynthesisSimulator object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoded_data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">encoded_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">encoded_data</span><span class="p">,</span> <span class="n">EncodedData</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="n">encoded_data</span><span class="o">.</span><span class="n">file_paths</span>
            <span class="c1">#self.size = encoded_data.size</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>        

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;DATA: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[:</span><span class="mi">50</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="c1"># output = &quot;\n&quot; + &quot;Type: &quot; + str(type(self)) + &quot;\n&quot;</span>
        <span class="c1"># #output += &quot;Bytes:&quot; + str(self.calculate_total_bytes()) + &quot;\n&quot;</span>
        <span class="c1"># output += &quot;DATA: &quot; + str(self.data)[:200] + &quot;...\n&quot;</span>
        <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div><h3 id="storedddata">StoreddData<a class="headerlink" href="#storedddata" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<a id="dnabyte.data.StoredData"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="dnabyte.data.DNADS" href="#dnabyte.data.DNADS">DNADS</a></code></p>


        <p>StoredData is a subclass of DNADS. It consists of a list of stored codewords generated from the list of synthesized codewords of the SynthesizedData object.</p>
<p>:param synthesized_data: A SynthesizedData object.
:param storage_simulator: A StorageSimulator object.</p>







              <details class="quote">
                <summary>Source code in <code>dnabyte/data.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">StoredData</span><span class="p">(</span><span class="n">DNADS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    StoredData is a subclass of DNADS. It consists of a list of stored codewords generated from the list of synthesized codewords of the SynthesizedData object.</span>

<span class="sd">    :param synthesized_data: A SynthesizedData object.</span>
<span class="sd">    :param storage_simulator: A StorageSimulator object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assembled_data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">assembled_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">assembled_data</span><span class="p">,</span> <span class="n">AssembledData</span><span class="p">):</span>                                        
            <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="n">assembled_data</span><span class="o">.</span><span class="n">file_paths</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">assembled_data</span><span class="o">.</span><span class="n">size</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">assembled_data</span><span class="o">.</span><span class="n">scale</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">assembled_data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;DATA: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[:</span><span class="mi">50</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="c1"># output = &quot;\n&quot; + &quot;Type: &quot; + str(type(self)) + &quot;\n&quot;</span>
        <span class="c1"># if self.file_paths is not None:</span>
        <span class="c1">#     output += &quot;File paths: &quot; + str(self.file_paths) + &quot;\n&quot;</span>
        <span class="c1">#     output += &quot;Bytes:&quot; + str(self.calculate_total_bytes()) + &quot;\n&quot;</span>
        <span class="c1"># output += &quot;DATA: &quot; + str(self.data)[:200] + &quot;...\n&quot;</span>
        <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div><h3 id="sequenceddata">SequencedData<a class="headerlink" href="#sequenceddata" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<a id="dnabyte.data.SequencedData"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="dnabyte.data.DNADS" href="#dnabyte.data.DNADS">DNADS</a></code></p>


        <p>SequencedData is a subclass of DNADS. It consists of a list of codewords generated from the list of stored codewords of the StoredData object.</p>
<p>:param data: A StoredData object.
:param sequencing_simulator: A SequencingSimulator object.</p>







              <details class="quote">
                <summary>Source code in <code>dnabyte/data.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SequencedData</span><span class="p">(</span><span class="n">DNADS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    SequencedData is a subclass of DNADS. It consists of a list of codewords generated from the list of stored codewords of the StoredData object.</span>

<span class="sd">    :param data: A StoredData object.</span>
<span class="sd">    :param sequencing_simulator: A SequencingSimulator object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">StoredData</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">file_paths</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">size</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">scale</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;DATA: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[:</span><span class="mi">50</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="c1"># output = &quot;\n&quot; + &quot;Type: &quot; + str(type(self)) + &quot;\n&quot;</span>
        <span class="c1"># if self.file_paths is not None:</span>
        <span class="c1">#     output += &quot;File paths: &quot; + str(self.file_paths) + &quot;\n&quot;</span>
        <span class="c1">#     output += &quot;Bytes:&quot; + str(self.calculate_total_bytes()) + &quot;\n&quot;</span>
        <span class="c1"># output += &quot;DATA: &quot; + str(self.data)[:200] + &quot;...\n&quot;</span>
        <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div><h3 id="correcteddata">CorrectedData<a class="headerlink" href="#correcteddata" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<a id="dnabyte.data.CorrectedData"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="dnabyte.data.DNADS" href="#dnabyte.data.DNADS">DNADS</a></code></p>








              <details class="quote">
                <summary>Source code in <code>dnabyte/data.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CorrectedData</span><span class="p">(</span><span class="n">DNADS</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequenced_data</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sequenced_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sequenced_data</span><span class="p">,</span> <span class="n">SequencedData</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="n">sequenced_data</span><span class="o">.</span><span class="n">file_paths</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">sequenced_data</span><span class="o">.</span><span class="n">size</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">sequenced_data</span><span class="o">.</span><span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">sequenced_data</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;DATA: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[:</span><span class="mi">50</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="c1"># output = &quot;\n&quot; + &quot;Type: &quot; + str(type(self)) + &quot;\n&quot;</span>
        <span class="c1"># if self.file_paths is not None:</span>
        <span class="c1">#     output += &quot;File paths: &quot; + str(self.file_paths) + &quot;\n&quot;</span>
        <span class="c1">#     output += &quot;Bytes:&quot; + str(self.calculate_total_bytes()) + &quot;\n&quot;</span>
        <span class="c1"># output += &quot;DATA: &quot; + str(self.data)[:200] + &quot;...\n&quot;</span>
        <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div><h3 id="decodeddata">DecodedData<a class="headerlink" href="#decodeddata" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<a id="dnabyte.data.DecodedData"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="dnabyte.data.DNADS" href="#dnabyte.data.DNADS">DNADS</a></code></p>


        <p>DecodedData is a subclass of DNADS. It consists of a bitstream created from the list of sequenced codewords of the SequencedData object.</p>
<p>:param sequenced_data: A SequencedData object.
:param encoding_scheme: An EncodingScheme object.</p>







              <details class="quote">
                <summary>Source code in <code>dnabyte/data.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DecodedData</span><span class="p">(</span><span class="n">DNADS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    DecodedData is a subclass of DNADS. It consists of a bitstream created from the list of sequenced codewords of the SequencedData object.</span>

<span class="sd">    :param sequenced_data: A SequencedData object.</span>
<span class="sd">    :param encoding_scheme: An EncodingScheme object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequenced_data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="n">sequenced_data</span><span class="o">.</span><span class="n">file_paths</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">sequenced_data</span><span class="o">.</span><span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;DATA: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[:</span><span class="mi">50</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="c1"># output = &quot;\n&quot; + &quot;Type: &quot; + str(type(self)) + &quot;\n&quot;</span>
        <span class="c1"># if self.file_paths is not None:</span>
        <span class="c1">#     output += &quot;File paths: &quot; + str(self.file_paths) + &quot;\n&quot;</span>
        <span class="c1">#     output += &quot;Bytes:&quot; + str(self.calculate_total_bytes()) + &quot;\n&quot;</span>
        <span class="c1"># output += &quot;DATA: &quot; + str(self.data)[:200] + &quot;...\n&quot;</span>
        <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div><h3 id="restoreddata">RestoredData<a class="headerlink" href="#restoreddata" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<a id="dnabyte.data.RestoredData"></a>
    <div class="doc doc-contents first">


        <p>RestoredData is a class that reconstructs the original files from a binary sequence.</p>
<p>:param raw_data: A RawData object.
:param output_folder: The folder where the restored files will be saved.</p>







              <details class="quote">
                <summary>Source code in <code>dnabyte/data.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">RestoredData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    RestoredData is a class that reconstructs the original files from a binary sequence.</span>

<span class="sd">    :param raw_data: A RawData object.</span>
<span class="sd">    :param output_folder: The folder where the restored files will be saved.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_data</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">,</span> <span class="n">job_identifier</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reconstructs the original files from a binary sequence.</span>

<span class="sd">        :param raw_data: A RawData object.</span>
<span class="sd">        :param output_folder: The folder where the restored files will be saved.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Suppress the specific DeprecationWarning</span>
        <span class="c1"># Warnings.filterwarnings(&quot;ignore&quot;, category=DeprecationWarning)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">file_paths</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">data</span>

        <span class="c1"># Convert binary sequence back to bytes</span>
        <span class="n">byte_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="mi">8</span><span class="p">))</span>

        <span class="c1"># Create a temporary tar archive file</span>
        <span class="n">archive_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">job_identifier</span> <span class="o">+</span> <span class="s1">&#39;_restored.tar.gz&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">archive_name</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">byte_data</span><span class="p">)</span>

        <span class="c1"># Extract the tar archive</span>
        <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">archive_name</span><span class="p">,</span> <span class="s1">&#39;r:gz&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">archive</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">archive</span><span class="o">.</span><span class="n">getmembers</span><span class="p">():</span>
                <span class="c1"># Remove the path information and add &quot;_restored&quot; to the file name</span>
                <span class="n">original_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">member</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">restored_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">original_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_restored</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">original_name</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">member</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">restored_name</span>
                <span class="n">archive</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">)</span>

        <span class="c1"># Remove the temporary tar archive file</span>
        <span class="c1">#os.remove(archive_name)</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;DATA: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)[:</span><span class="mi">50</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="c1"># output = &quot;\n&quot; + &quot;Type: &quot; + str(type(self)) + &quot;\n&quot;</span>
        <span class="c1"># if self.file_paths is not None:</span>
        <span class="c1">#     output += &quot;File paths: &quot; + str(self.file_paths) + &quot;\n&quot;</span>
        <span class="c1">#     output += &quot;Bytes:&quot; + str(self.calculate_total_bytes()) + &quot;\n&quot;</span>
        <span class="c1"># output += &quot;DATA: &quot; + str(self.data)[:200] + &quot;...\n&quot;</span>
        <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="dnabyte.data.RestoredData.__init__" class="doc doc-heading">
            <code class=" language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">,</span> <span class="n">job_identifier</span><span class="p">)</span></code>

<a href="#dnabyte.data.RestoredData.__init__" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Reconstructs the original files from a binary sequence.</p>
<p>:param raw_data: A RawData object.
:param output_folder: The folder where the restored files will be saved.</p>


            <details class="quote">
              <summary>Source code in <code>dnabyte/data.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_data</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">,</span> <span class="n">job_identifier</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reconstructs the original files from a binary sequence.</span>

<span class="sd">    :param raw_data: A RawData object.</span>
<span class="sd">    :param output_folder: The folder where the restored files will be saved.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Suppress the specific DeprecationWarning</span>
    <span class="c1"># Warnings.filterwarnings(&quot;ignore&quot;, category=DeprecationWarning)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">file_paths</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">data</span>

    <span class="c1"># Convert binary sequence back to bytes</span>
    <span class="n">byte_data</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">),</span> <span class="mi">8</span><span class="p">))</span>

    <span class="c1"># Create a temporary tar archive file</span>
    <span class="n">archive_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_folder</span><span class="p">,</span> <span class="n">job_identifier</span> <span class="o">+</span> <span class="s1">&#39;_restored.tar.gz&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">archive_name</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">byte_data</span><span class="p">)</span>

    <span class="c1"># Extract the tar archive</span>
    <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">archive_name</span><span class="p">,</span> <span class="s1">&#39;r:gz&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">archive</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">archive</span><span class="o">.</span><span class="n">getmembers</span><span class="p">():</span>
            <span class="c1"># Remove the path information and add &quot;_restored&quot; to the file name</span>
            <span class="n">original_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">member</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">restored_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">original_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_restored</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">original_name</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">member</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">restored_name</span>
            <span class="n">archive</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="params">Params<a class="headerlink" href="#params" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-module">



<a id="dnabyte.params"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="dnabyte.params.Params" class="doc doc-heading">
            <code>Params</code>


<a href="#dnabyte.params.Params" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">








              <details class="quote">
                <summary>Source code in <code>dnabyte/params.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Params</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
                 <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">assembly_structure</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">encoding_scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">inner_error_correction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">outer_error_correction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">dna_barcode_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">codeword_maxlength_positions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">sigma_amount</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">codeword_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">percent_of_symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">index_carry_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">reed_solo_percentage</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">synthesis_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">mean</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">vol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">std_dev</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">hybridisation_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">years</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">storage_conditions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">sequencing_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">iid_error_rate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">library_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                 <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">theory</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">ltcode_header</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">=</span> <span class="n">assembly_structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">=</span> <span class="n">encoding_scheme</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inner_error_correction</span> <span class="o">=</span> <span class="n">inner_error_correction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outer_error_correction</span> <span class="o">=</span> <span class="n">outer_error_correction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dna_barcode_length</span> <span class="o">=</span> <span class="n">dna_barcode_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">codeword_maxlength_positions</span> <span class="o">=</span> <span class="n">codeword_maxlength_positions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_amount</span> <span class="o">=</span> <span class="n">sigma_amount</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">codeword_length</span> <span class="o">=</span> <span class="n">codeword_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percent_of_symbols</span> <span class="o">=</span> <span class="n">percent_of_symbols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_carry_length</span> <span class="o">=</span> <span class="n">index_carry_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reed_solo_percentage</span> <span class="o">=</span> <span class="n">reed_solo_percentage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">synthesis_method</span> <span class="o">=</span> <span class="n">synthesis_method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">mean</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vol</span> <span class="o">=</span> <span class="n">vol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span> <span class="o">=</span> <span class="n">std_dev</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hybridisation_steps</span> <span class="o">=</span> <span class="n">hybridisation_steps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">years</span> <span class="o">=</span> <span class="n">years</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storage_conditions</span> <span class="o">=</span> <span class="n">storage_conditions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequencing_method</span> <span class="o">=</span> <span class="n">sequencing_method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">library_name</span> <span class="o">=</span> <span class="n">library_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theory</span> <span class="o">=</span> <span class="n">theory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ltcode_header</span> <span class="o">=</span> <span class="n">ltcode_header</span>

        <span class="c1"># check the validity of the parameters</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequencing_method</span> <span class="o">==</span> <span class="s1">&#39;iid&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iid_error_rate</span> <span class="o">=</span> <span class="n">iid_error_rate</span>

        <span class="c1"># check that the library is compatible with the selected assembly structure</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">library_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;./app/static/libraries/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">library_name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">first_line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> 
            <span class="k">if</span> <span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">first_line</span> <span class="o">==</span> <span class="s1">&#39;Messages&#39;</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Library not compatible with linear assembly&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">library</span> <span class="o">=</span> <span class="n">Library</span><span class="p">(</span><span class="n">structure</span><span class="o">=</span><span class="n">assembly_structure</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;./app/static/libraries/&#39;</span> <span class="o">+</span> <span class="n">library_name</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">first_line</span> <span class="o">==</span> <span class="s1">&#39;Messages&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">library</span> <span class="o">=</span> <span class="n">Library</span><span class="p">(</span><span class="n">structure</span><span class="o">=</span><span class="n">assembly_structure</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;./app/static/libraries/&#39;</span> <span class="o">+</span> <span class="n">library_name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Library not compatible with positional assembly&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Library not compatible with synthesis&quot;</span><span class="p">)</span>

        <span class="c1">#assure message carring part is at least 1 oligo long</span>
        <span class="k">if</span> <span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">:</span>
                <span class="n">max_codeword_length</span> <span class="o">=</span> <span class="n">codeword_length</span>
            <span class="k">elif</span> <span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>
                <span class="n">max_codeword_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">leftmotives</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">rightmotives</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span><span class="p">:</span>
            <span class="n">max_codeword_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">position</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">inner_error_correction</span> <span class="o">==</span> <span class="s1">&#39;ltcode&#39;</span><span class="p">:</span>
            <span class="n">message_length</span> <span class="o">=</span> <span class="n">max_codeword_length</span> <span class="o">-</span> <span class="n">dna_barcode_length</span> <span class="o">-</span> <span class="n">codeword_maxlength_positions</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">index_carry_length</span> <span class="o">-</span> <span class="n">ltcode_header</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">message_length</span> <span class="o">=</span> <span class="n">max_codeword_length</span> <span class="o">-</span> <span class="n">dna_barcode_length</span> <span class="o">-</span> <span class="n">codeword_maxlength_positions</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">message_length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid code word split.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;linear_encoding&#39;</span><span class="p">,</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">,</span> <span class="s1">&#39;max_density_encoding&#39;</span><span class="p">,</span> <span class="s1">&#39;no_homopolymer_encoding&#39;</span><span class="p">,</span><span class="s1">&#39;no_homopolymeroddeven_encoding&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid encoding scheme&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;synthesis&#39;</span><span class="p">,</span> <span class="s1">&#39;linear_assembly&#39;</span><span class="p">,</span> <span class="s1">&#39;positional_assembly&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid library structure&quot;</span><span class="p">)</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_error_correction</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ltcode&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid inner error correction&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_error_correction</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;reedsolomon&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid outer error correction&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_error_correction</span> <span class="o">==</span> <span class="s1">&#39;reedsolomon&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reed_solo_percentage</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">reed_solo_percentage</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Reedsolomon percentage not compatible&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_error_correction</span> <span class="o">==</span> <span class="s1">&#39;ltcode&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">percent_of_symbols</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">percent_of_symbols</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Percent of symbols not compatible&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_carry_length</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Index carry length not compatible&quot;</span><span class="p">)</span>    

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">library_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Library not provided&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_amount</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">theory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing parameters for encoding scheme&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">codeword_length</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">theory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing parameters for encoding scheme&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;synthesis&#39;</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">)):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">codeword_length</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing parameters for encoding scheme&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theory</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing parameters for encoding scheme&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequencing_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">41</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span><span class="s1">&#39;iid&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid sequencing method&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">synthesis_method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="s1">&#39;nosynthpoly&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid Synthesis Error&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_conditions</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;permafrost&#39;</span><span class="p">,</span> <span class="s1">&#39;room_temperature&#39;</span><span class="p">,</span> <span class="s1">&#39;biogene&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid storage conditions&quot;</span><span class="p">)</span>

        <span class="c1"># NOTE: This is here for testing library distances, to be removed after simulations are done</span>

        <span class="c1"># min_distance = float(&#39;inf&#39;)  # Initialize with infinity</span>
        <span class="c1"># closest_strings = []         # List to store strings with the smallest distance</span>

        <span class="c1"># for m in self.library.library:</span>
        <span class="c1">#     for s in self.library.library:</span>
        <span class="c1">#         if m != s:  # Avoid comparing the same string</span>
        <span class="c1">#             distance = damerau_levenshtein_distance(m, s)  # Calculate the distance</span>
        <span class="c1">#             if distance &lt; min_distance:</span>
        <span class="c1">#                 min_distance = distance  # Update the smallest distance</span>

        <span class="c1"># print(f&quot;Minimum distance: {min_distance}&quot;)</span>
        <span class="c1"># breakpoint()</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Filename: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Assembly structure: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Encoding scheme: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Inner error correction: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_error_correction</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Outer error correction: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_error_correction</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;DNA barcode length: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dna_barcode_length</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Codeword max length positions: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">codeword_maxlength_positions</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Sigma amount: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma_amount</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Codeword length: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">codeword_length</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Percent of symbols: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">percent_of_symbols</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Index carry length: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">index_carry_length</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Reed-Solo percentage: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">reed_solo_percentage</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Synthesis method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">synthesis_method</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Mean: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Volume: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">vol</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Standard deviation: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Hybridisation steps: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">hybridisation_steps</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Years: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Storage conditions: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">storage_conditions</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Sequencing method: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">sequencing_method</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Library name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">library_name</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Seed: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Debug: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;Theory: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">theory</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">output</span>


    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">params_range</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Alternative constructor that creates a list of Params instances for each item in the list if one of the parameters is a non-empty list.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        kwargs (dict): The parameters for the Params instances.</span>

<span class="sd">        Returns:</span>
<span class="sd">        list: A list of Params instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Find the first attribute that is a non-empty list</span>
        <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr_value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">attr_value</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">attr_value</span><span class="p">:</span>
                    <span class="n">new_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">:</span> <span class="n">item</span><span class="p">}</span>
                    <span class="n">params_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">new_kwargs</span><span class="p">))</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If no attribute is a non-empty list, return a list with a single instance</span>
            <span class="n">params_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">params_list</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="dnabyte.params.Params.params_range" class="doc doc-heading">
            <code class=" language-python"><span class="n">params_range</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#dnabyte.params.Params.params_range" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Alternative constructor that creates a list of Params instances for each item in the list if one of the parameters is a non-empty list.</p>
<p>Parameters:
kwargs (dict): The parameters for the Params instances.</p>
<p>Returns:
list: A list of Params instances.</p>


            <details class="quote">
              <summary>Source code in <code>dnabyte/params.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">params_range</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Alternative constructor that creates a list of Params instances for each item in the list if one of the parameters is a non-empty list.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    kwargs (dict): The parameters for the Params instances.</span>

<span class="sd">    Returns:</span>
<span class="sd">    list: A list of Params instances.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">params_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Find the first attribute that is a non-empty list</span>
    <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr_value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">attr_value</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">attr_value</span><span class="p">:</span>
                <span class="n">new_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">:</span> <span class="n">item</span><span class="p">}</span>
                <span class="n">params_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">new_kwargs</span><span class="p">))</span>
            <span class="k">break</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># If no attribute is a non-empty list, return a list with a single instance</span>
        <span class="n">params_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">cls</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">params_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div><h2 id="encode">Encode<a class="headerlink" href="#encode" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="dnabyte.encode"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="dnabyte.encode.Encode" class="doc doc-heading">
            <code>Encode</code>


<a href="#dnabyte.encode.Encode" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>This class is responsible for encoding the raw data into sequences of oligos.</p>
<p>There are three steps involved in encoding:
1. Splitting raw data into codewords. This step also includes error correction and barcoding.
2. Encoding the codewords into sequences of oligos. This is called the blueprint.
3. Subsetting the blueprint into pooling sequences.</p>







              <details class="quote">
                <summary>Source code in <code>dnabyte/encode.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Encode</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is responsible for encoding the raw data into sequences of oligos.</span>

<span class="sd">    There are three steps involved in encoding:</span>
<span class="sd">    1. Splitting raw data into codewords. This step also includes error correction and barcoding.</span>
<span class="sd">    2. Encoding the codewords into sequences of oligos. This is called the blueprint.</span>
<span class="sd">    3. Subsetting the blueprint into pooling sequences. </span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">assembly_structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">encoding_scheme</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inner_error_correction</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">inner_error_correction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outer_error_correction</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">outer_error_correction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dna_barcode_length</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">dna_barcode_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">codeword_maxlength_positions</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">codeword_maxlength_positions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigmaamount</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">sigma_amount</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">codewordlength</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">codeword_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percentofsymbols</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">percent_of_symbols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indexcarrylength</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">index_carry_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reedsolopercentage</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">reed_solo_percentage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">library_name</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">library_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">library</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">library</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theory</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">theory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Encodes the raw data based on the library structure and encoding scheme.</span>

<span class="sd">        This method encodes the provided raw data using the specified encoding scheme</span>
<span class="sd">        and library structure. The encoding scheme and library structure determine</span>
<span class="sd">        which encoding function is used.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        raw_data (RawData): The raw data to be encoded. Must be an instance of RawData.</span>

<span class="sd">        Returns:</span>
<span class="sd">        EncodedData: An EncodedData object containing the encoded data.</span>

<span class="sd">        Raises:</span>
<span class="sd">        TypeError: If raw_data is not an instance of RawData.</span>
<span class="sd">        ValueError: If the encoding scheme or library structure is invalid.</span>

<span class="sd">        Encoding Schemes:</span>
<span class="sd">        - &#39;linear_assembly&#39; structure with &#39;linear_encoding&#39; encoding: Uses Encode_chain_simp.</span>
<span class="sd">        - &#39;linear_assembly&#39; structure with &#39;binomial_encoding&#39; encoding: Uses Encode_binom_simp.</span>
<span class="sd">        - &#39;positional_assembly&#39; structure with &#39;linear_encoding&#39; encoding: Uses Encode_chain_poly.</span>
<span class="sd">        - &#39;positional_assembly&#39; structure with &#39;binomial_encoding&#39; encoding: Uses Encode_binom_poly.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.encode_maxdensity</span><span class="w"> </span><span class="kn">import</span> <span class="n">EncodeMaxDensity</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.encode_nohomopolyoddeven</span><span class="w"> </span><span class="kn">import</span> <span class="n">EncodeNoHomoPolyOddEven</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.encode_linear_chain</span><span class="w"> </span><span class="kn">import</span> <span class="n">EncodeLinearChain</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.encode_linear_binom</span><span class="w"> </span><span class="kn">import</span> <span class="n">EncodeLinearBinom</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.encode_poly_chain</span><span class="w"> </span><span class="kn">import</span> <span class="n">EncodePolyChain</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.encode_poly_binom</span><span class="w"> </span><span class="kn">import</span> <span class="n">EncodePolyBinom</span>


        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">RawData</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;raw_data must be an instance of RawData&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">:</span>
            <span class="n">enc</span> <span class="o">=</span> <span class="n">EncodeLinearChain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">encoded_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">encode_linear_chain</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>
            <span class="n">enc</span> <span class="o">=</span> <span class="n">EncodeLinearBinom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">encoded_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">encode_linear_binom</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">:</span>
            <span class="n">enc</span> <span class="o">=</span> <span class="n">EncodePolyChain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">encoded_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">encode_chain_poly</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>
            <span class="n">enc</span> <span class="o">=</span> <span class="n">EncodePolyBinom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">encoded_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">encode_binom_poly</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;synthesis&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;max_density_encoding&#39;</span><span class="p">:</span>
            <span class="n">enc</span> <span class="o">=</span> <span class="n">EncodeMaxDensity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">encoded_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">encode_max_density</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;synthesis&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;no_homopolymeroddeven_encoding&#39;</span><span class="p">:</span>
            <span class="n">enc</span> <span class="o">=</span> <span class="n">EncodeNoHomoPolyOddEven</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">encoded_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">encode_nohomopoly_odd_even</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid encoding scheme or library structure&quot;</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">EncodedData</span><span class="p">(</span><span class="n">encoded_data</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">file_paths</span>

        <span class="k">return</span> <span class="n">obj</span><span class="p">,</span> <span class="n">info</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corrected_data</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Decodes the corrected data based on the assembly structure and encoding scheme.</span>

<span class="sd">        This method decodes the provided corrected data using the specified assembly structure</span>
<span class="sd">        and encoding scheme. The assembly structure and encoding scheme determine</span>
<span class="sd">        which decoding function is used.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        corrected_data (CorrectedData): The corrected data to be decoded. Must be an instance of CorrectedData.</span>

<span class="sd">        Returns:</span>
<span class="sd">        DecodedData: A DecodedData object containing the decoded data.</span>

<span class="sd">        Raises:</span>
<span class="sd">        TypeError: If corrected_data is not an instance of CorrectedData.</span>
<span class="sd">        ValueError: If the encoding scheme or library structure is invalid.</span>

<span class="sd">        Assembly Structures:</span>
<span class="sd">        - &#39;linear_assembly&#39; with &#39;linear_encoding&#39; encoding: Uses Decode_simple_chain.</span>
<span class="sd">        - &#39;linear_assembly&#39; with &#39;binomial_encoding&#39; encoding: Uses Decode_simple_binom.</span>
<span class="sd">        - &#39;positional_assembly&#39; with &#39;linear_encoding&#39; encoding: Uses Decode_poly_chain.</span>
<span class="sd">        - &#39;positional_assembly&#39; with &#39;binomial_encoding&#39; encoding: Uses Decode_poly_binom.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.decode_linear_chain</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecodeLinearChain</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.decode_linear_binom</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecodeLinearBinom</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.decode_poly_chain</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecodePolyChain</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.decode_poly_binom</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecodePolyBinom</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.decode_maxdensity</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecodeMaxDensity</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.decode_nohomopolyoddeven</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecodeNoHomoPolyOddEven</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">,</span> <span class="n">CorrectedData</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;corrected_data must be an instance of CorrectedData&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">:</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="n">DecodeLinearChain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">decoded_data</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">dec</span><span class="o">.</span><span class="n">decode_linear_chain</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="n">DecodeLinearBinom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">decoded_data</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">dec</span><span class="o">.</span><span class="n">decode_linear_binom</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">:</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="n">DecodePolyChain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">decoded_data</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">dec</span><span class="o">.</span><span class="n">decode_poly_chain</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="n">DecodePolyBinom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">decoded_data</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">dec</span><span class="o">.</span><span class="n">decode_poly_binom</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;synthesis&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;max_density_encoding&#39;</span><span class="p">:</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="n">DecodeMaxDensity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">decoded_data</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">dec</span><span class="o">.</span><span class="n">decode_maxdensity</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;synthesis&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;no_homopolymeroddeven_encoding&#39;</span><span class="p">:</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="n">DecodeNoHomoPolyOddEven</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">decoded_data</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">dec</span><span class="o">.</span><span class="n">decode_nohomopolyoddeven</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid encoding scheme or library structure&quot;</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">DecodedData</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">decoded_data</span>

        <span class="k">return</span> <span class="n">obj</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">info</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Processes the sequenced data based on the assembly structure and encoding scheme.</span>

<span class="sd">        This method processes the provided sequenced data using the specified assembly structure</span>
<span class="sd">        and encoding scheme. The assembly structure and encoding scheme determine</span>
<span class="sd">        which processing function is used.</span>

<span class="sd">        Parameters:</span>
<span class="sd">        data (SequencedData): The sequenced data to be processed. Must be an instance of SequencedData.</span>

<span class="sd">        Returns:</span>
<span class="sd">        CorrectedData: A CorrectedData object containing the processed data.</span>

<span class="sd">        Raises:</span>
<span class="sd">        TypeError: If data is not an instance of SequencedData.</span>
<span class="sd">        ValueError: If the encoding scheme or library structure is invalid.</span>

<span class="sd">        Assembly Structures:</span>
<span class="sd">        - &#39;linear_assembly&#39; with &#39;linear_encoding&#39; encoding: Uses Process.</span>
<span class="sd">        - &#39;linear_assembly&#39; with &#39;binomial_encoding&#39; encoding: Uses Process.</span>
<span class="sd">        - &#39;positional_assembly&#39; with &#39;linear_encoding&#39; encoding: Uses Process.</span>
<span class="sd">        - &#39;positional_assembly&#39; with &#39;binomial_encoding&#39; encoding: Uses Process.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.process_maxdensity</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProcessMaxDensity</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.process_nohomopolyoddeven</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProcessNoHomoPolyOddEven</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.process_linear_chain</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProcessLinearChain</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.process_linear_binom</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProcessLinearBinom</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.process_poly_chain</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProcessPolyChain</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.process_poly_binom</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProcessPolyBinom</span>

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">SequencedData</span><span class="p">):</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;synthesis&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;max_density_encoding&#39;</span><span class="p">:</span>
                <span class="n">pro</span> <span class="o">=</span> <span class="n">ProcessMaxDensity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
                <span class="n">processed_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">process_maxdensity</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;synthesis&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;no_homopolymeroddeven_encoding&#39;</span><span class="p">:</span>
                <span class="n">pro</span> <span class="o">=</span> <span class="n">ProcessNoHomoPolyOddEven</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
                <span class="n">processed_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">process_nohomopolyoddeven</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">:</span>
                <span class="n">pro</span> <span class="o">=</span> <span class="n">ProcessLinearChain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
                <span class="n">processed_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">process_linear_chain</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>
                <span class="n">pro</span> <span class="o">=</span> <span class="n">ProcessLinearBinom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
                <span class="n">processed_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">process_linear_binom</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">:</span>
                <span class="n">pro</span> <span class="o">=</span> <span class="n">ProcessPolyChain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
                <span class="n">processed_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">process_poly_chain</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>
                <span class="n">pro</span> <span class="o">=</span> <span class="n">ProcessPolyBinom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
                <span class="n">processed_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">process_poly_binom</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">CorrectedData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">processed_data</span>

        <span class="k">return</span> <span class="n">obj</span><span class="p">,</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="dnabyte.encode.Encode.decode" class="doc doc-heading">
            <code class=" language-python"><span class="n">decode</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">)</span></code>

<a href="#dnabyte.encode.Encode.decode" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Decodes the corrected data based on the assembly structure and encoding scheme.</p>
<p>This method decodes the provided corrected data using the specified assembly structure
and encoding scheme. The assembly structure and encoding scheme determine
which decoding function is used.</p>
<p>Parameters:
corrected_data (CorrectedData): The corrected data to be decoded. Must be an instance of CorrectedData.</p>
<p>Returns:
DecodedData: A DecodedData object containing the decoded data.</p>
<p>Raises:
TypeError: If corrected_data is not an instance of CorrectedData.
ValueError: If the encoding scheme or library structure is invalid.</p>
<p>Assembly Structures:
- 'linear_assembly' with 'linear_encoding' encoding: Uses Decode_simple_chain.
- 'linear_assembly' with 'binomial_encoding' encoding: Uses Decode_simple_binom.
- 'positional_assembly' with 'linear_encoding' encoding: Uses Decode_poly_chain.
- 'positional_assembly' with 'binomial_encoding' encoding: Uses Decode_poly_binom.</p>


            <details class="quote">
              <summary>Source code in <code>dnabyte/encode.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">corrected_data</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decodes the corrected data based on the assembly structure and encoding scheme.</span>

<span class="sd">    This method decodes the provided corrected data using the specified assembly structure</span>
<span class="sd">    and encoding scheme. The assembly structure and encoding scheme determine</span>
<span class="sd">    which decoding function is used.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    corrected_data (CorrectedData): The corrected data to be decoded. Must be an instance of CorrectedData.</span>

<span class="sd">    Returns:</span>
<span class="sd">    DecodedData: A DecodedData object containing the decoded data.</span>

<span class="sd">    Raises:</span>
<span class="sd">    TypeError: If corrected_data is not an instance of CorrectedData.</span>
<span class="sd">    ValueError: If the encoding scheme or library structure is invalid.</span>

<span class="sd">    Assembly Structures:</span>
<span class="sd">    - &#39;linear_assembly&#39; with &#39;linear_encoding&#39; encoding: Uses Decode_simple_chain.</span>
<span class="sd">    - &#39;linear_assembly&#39; with &#39;binomial_encoding&#39; encoding: Uses Decode_simple_binom.</span>
<span class="sd">    - &#39;positional_assembly&#39; with &#39;linear_encoding&#39; encoding: Uses Decode_poly_chain.</span>
<span class="sd">    - &#39;positional_assembly&#39; with &#39;binomial_encoding&#39; encoding: Uses Decode_poly_binom.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.decode_linear_chain</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecodeLinearChain</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.decode_linear_binom</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecodeLinearBinom</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.decode_poly_chain</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecodePolyChain</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.decode_poly_binom</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecodePolyBinom</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.decode_maxdensity</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecodeMaxDensity</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.decode_nohomopolyoddeven</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecodeNoHomoPolyOddEven</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">,</span> <span class="n">CorrectedData</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;corrected_data must be an instance of CorrectedData&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">:</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="n">DecodeLinearChain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
        <span class="n">decoded_data</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">dec</span><span class="o">.</span><span class="n">decode_linear_chain</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">)</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="n">DecodeLinearBinom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
        <span class="n">decoded_data</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">dec</span><span class="o">.</span><span class="n">decode_linear_binom</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">)</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">:</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="n">DecodePolyChain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
        <span class="n">decoded_data</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">dec</span><span class="o">.</span><span class="n">decode_poly_chain</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">)</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="n">DecodePolyBinom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
        <span class="n">decoded_data</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">dec</span><span class="o">.</span><span class="n">decode_poly_binom</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">)</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;synthesis&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;max_density_encoding&#39;</span><span class="p">:</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="n">DecodeMaxDensity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
        <span class="n">decoded_data</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">dec</span><span class="o">.</span><span class="n">decode_maxdensity</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">)</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;synthesis&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;no_homopolymeroddeven_encoding&#39;</span><span class="p">:</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="n">DecodeNoHomoPolyOddEven</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
        <span class="n">decoded_data</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">dec</span><span class="o">.</span><span class="n">decode_nohomopolyoddeven</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid encoding scheme or library structure&quot;</span><span class="p">)</span>

    <span class="n">obj</span> <span class="o">=</span> <span class="n">DecodedData</span><span class="p">(</span><span class="n">corrected_data</span><span class="p">)</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">decoded_data</span>

    <span class="k">return</span> <span class="n">obj</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dnabyte.encode.Encode.encode" class="doc doc-heading">
            <code class=" language-python"><span class="n">encode</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span></code>

<a href="#dnabyte.encode.Encode.encode" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Encodes the raw data based on the library structure and encoding scheme.</p>
<p>This method encodes the provided raw data using the specified encoding scheme
and library structure. The encoding scheme and library structure determine
which encoding function is used.</p>
<p>Parameters:
raw_data (RawData): The raw data to be encoded. Must be an instance of RawData.</p>
<p>Returns:
EncodedData: An EncodedData object containing the encoded data.</p>
<p>Raises:
TypeError: If raw_data is not an instance of RawData.
ValueError: If the encoding scheme or library structure is invalid.</p>
<p>Encoding Schemes:
- 'linear_assembly' structure with 'linear_encoding' encoding: Uses Encode_chain_simp.
- 'linear_assembly' structure with 'binomial_encoding' encoding: Uses Encode_binom_simp.
- 'positional_assembly' structure with 'linear_encoding' encoding: Uses Encode_chain_poly.
- 'positional_assembly' structure with 'binomial_encoding' encoding: Uses Encode_binom_poly.</p>


            <details class="quote">
              <summary>Source code in <code>dnabyte/encode.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Encodes the raw data based on the library structure and encoding scheme.</span>

<span class="sd">    This method encodes the provided raw data using the specified encoding scheme</span>
<span class="sd">    and library structure. The encoding scheme and library structure determine</span>
<span class="sd">    which encoding function is used.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    raw_data (RawData): The raw data to be encoded. Must be an instance of RawData.</span>

<span class="sd">    Returns:</span>
<span class="sd">    EncodedData: An EncodedData object containing the encoded data.</span>

<span class="sd">    Raises:</span>
<span class="sd">    TypeError: If raw_data is not an instance of RawData.</span>
<span class="sd">    ValueError: If the encoding scheme or library structure is invalid.</span>

<span class="sd">    Encoding Schemes:</span>
<span class="sd">    - &#39;linear_assembly&#39; structure with &#39;linear_encoding&#39; encoding: Uses Encode_chain_simp.</span>
<span class="sd">    - &#39;linear_assembly&#39; structure with &#39;binomial_encoding&#39; encoding: Uses Encode_binom_simp.</span>
<span class="sd">    - &#39;positional_assembly&#39; structure with &#39;linear_encoding&#39; encoding: Uses Encode_chain_poly.</span>
<span class="sd">    - &#39;positional_assembly&#39; structure with &#39;binomial_encoding&#39; encoding: Uses Encode_binom_poly.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.encode_maxdensity</span><span class="w"> </span><span class="kn">import</span> <span class="n">EncodeMaxDensity</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.encode_nohomopolyoddeven</span><span class="w"> </span><span class="kn">import</span> <span class="n">EncodeNoHomoPolyOddEven</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.encode_linear_chain</span><span class="w"> </span><span class="kn">import</span> <span class="n">EncodeLinearChain</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.encode_linear_binom</span><span class="w"> </span><span class="kn">import</span> <span class="n">EncodeLinearBinom</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.encode_poly_chain</span><span class="w"> </span><span class="kn">import</span> <span class="n">EncodePolyChain</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.encode_poly_binom</span><span class="w"> </span><span class="kn">import</span> <span class="n">EncodePolyBinom</span>


    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">RawData</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;raw_data must be an instance of RawData&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">:</span>
        <span class="n">enc</span> <span class="o">=</span> <span class="n">EncodeLinearChain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
        <span class="n">encoded_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">encode_linear_chain</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>
        <span class="n">enc</span> <span class="o">=</span> <span class="n">EncodeLinearBinom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
        <span class="n">encoded_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">encode_linear_binom</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">:</span>
        <span class="n">enc</span> <span class="o">=</span> <span class="n">EncodePolyChain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
        <span class="n">encoded_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">encode_chain_poly</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>
        <span class="n">enc</span> <span class="o">=</span> <span class="n">EncodePolyBinom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
        <span class="n">encoded_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">encode_binom_poly</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;synthesis&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;max_density_encoding&#39;</span><span class="p">:</span>
        <span class="n">enc</span> <span class="o">=</span> <span class="n">EncodeMaxDensity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
        <span class="n">encoded_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">encode_max_density</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;synthesis&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;no_homopolymeroddeven_encoding&#39;</span><span class="p">:</span>
        <span class="n">enc</span> <span class="o">=</span> <span class="n">EncodeNoHomoPolyOddEven</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
        <span class="n">encoded_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">encode_nohomopoly_odd_even</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid encoding scheme or library structure&quot;</span><span class="p">)</span>

    <span class="n">obj</span> <span class="o">=</span> <span class="n">EncodedData</span><span class="p">(</span><span class="n">encoded_data</span><span class="p">)</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">file_paths</span> <span class="o">=</span> <span class="n">raw_data</span><span class="o">.</span><span class="n">file_paths</span>

    <span class="k">return</span> <span class="n">obj</span><span class="p">,</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dnabyte.encode.Encode.process" class="doc doc-heading">
            <code class=" language-python"><span class="n">process</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

<a href="#dnabyte.encode.Encode.process" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Processes the sequenced data based on the assembly structure and encoding scheme.</p>
<p>This method processes the provided sequenced data using the specified assembly structure
and encoding scheme. The assembly structure and encoding scheme determine
which processing function is used.</p>
<p>Parameters:
data (SequencedData): The sequenced data to be processed. Must be an instance of SequencedData.</p>
<p>Returns:
CorrectedData: A CorrectedData object containing the processed data.</p>
<p>Raises:
TypeError: If data is not an instance of SequencedData.
ValueError: If the encoding scheme or library structure is invalid.</p>
<p>Assembly Structures:
- 'linear_assembly' with 'linear_encoding' encoding: Uses Process.
- 'linear_assembly' with 'binomial_encoding' encoding: Uses Process.
- 'positional_assembly' with 'linear_encoding' encoding: Uses Process.
- 'positional_assembly' with 'binomial_encoding' encoding: Uses Process.</p>


            <details class="quote">
              <summary>Source code in <code>dnabyte/encode.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Processes the sequenced data based on the assembly structure and encoding scheme.</span>

<span class="sd">    This method processes the provided sequenced data using the specified assembly structure</span>
<span class="sd">    and encoding scheme. The assembly structure and encoding scheme determine</span>
<span class="sd">    which processing function is used.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    data (SequencedData): The sequenced data to be processed. Must be an instance of SequencedData.</span>

<span class="sd">    Returns:</span>
<span class="sd">    CorrectedData: A CorrectedData object containing the processed data.</span>

<span class="sd">    Raises:</span>
<span class="sd">    TypeError: If data is not an instance of SequencedData.</span>
<span class="sd">    ValueError: If the encoding scheme or library structure is invalid.</span>

<span class="sd">    Assembly Structures:</span>
<span class="sd">    - &#39;linear_assembly&#39; with &#39;linear_encoding&#39; encoding: Uses Process.</span>
<span class="sd">    - &#39;linear_assembly&#39; with &#39;binomial_encoding&#39; encoding: Uses Process.</span>
<span class="sd">    - &#39;positional_assembly&#39; with &#39;linear_encoding&#39; encoding: Uses Process.</span>
<span class="sd">    - &#39;positional_assembly&#39; with &#39;binomial_encoding&#39; encoding: Uses Process.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.process_maxdensity</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProcessMaxDensity</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.process_nohomopolyoddeven</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProcessNoHomoPolyOddEven</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.process_linear_chain</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProcessLinearChain</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.process_linear_binom</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProcessLinearBinom</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.process_poly_chain</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProcessPolyChain</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dnabyte.process_poly_binom</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProcessPolyBinom</span>

    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">SequencedData</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;synthesis&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;max_density_encoding&#39;</span><span class="p">:</span>
            <span class="n">pro</span> <span class="o">=</span> <span class="n">ProcessMaxDensity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">processed_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">process_maxdensity</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;synthesis&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;no_homopolymeroddeven_encoding&#39;</span><span class="p">:</span>
            <span class="n">pro</span> <span class="o">=</span> <span class="n">ProcessNoHomoPolyOddEven</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">processed_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">process_nohomopolyoddeven</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">:</span>
            <span class="n">pro</span> <span class="o">=</span> <span class="n">ProcessLinearChain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">processed_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">process_linear_chain</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>
            <span class="n">pro</span> <span class="o">=</span> <span class="n">ProcessLinearBinom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">processed_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">process_linear_binom</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">:</span>
            <span class="n">pro</span> <span class="o">=</span> <span class="n">ProcessPolyChain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">processed_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">process_poly_chain</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>
            <span class="n">pro</span> <span class="o">=</span> <span class="n">ProcessPolyBinom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="p">)</span>
            <span class="n">processed_data</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">pro</span><span class="o">.</span><span class="n">process_poly_binom</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">obj</span> <span class="o">=</span> <span class="n">CorrectedData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">processed_data</span>

    <span class="k">return</span> <span class="n">obj</span><span class="p">,</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="dnabyte.assembly"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="dnabyte.assembly.SimulateAssembly" class="doc doc-heading">
            <code>SimulateAssembly</code>


<a href="#dnabyte.assembly.SimulateAssembly" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Simulate the assembly of single stranded oligos into long chaines of double stranded DNA.</p>







              <details class="quote">
                <summary>Source code in <code>dnabyte/assembly.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SimulateAssembly</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate the assembly of single stranded oligos into long chaines of double stranded DNA.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">assembly_structure</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">encoding_scheme</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">mean</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">std_dev</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vol</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">vol</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hybridisation_steps</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">hybridisation_steps</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">synthesis_method</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">synthesis_method</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">theory</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">theory</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">library</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">library</span>

            <span class="c1"># To allow simulation with large quantites of oligos, we will scale down the number, perform</span>
            <span class="c1"># the simulation, and then scale back up the results.</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">/</span> <span class="mi">10</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span> <span class="o">/</span> <span class="mi">10</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span> <span class="o">*</span> <span class="mi">10</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_list_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lst</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursively prints the structure of a list of lists.</span>

<span class="sd">        Args:</span>
<span class="sd">            lst (list): The list to analyze.</span>
<span class="sd">            level (int): The current nesting level (used for indentation).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  &quot;</span> <span class="o">*</span> <span class="n">level</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;Level </span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">: List with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span><span class="si">}</span><span class="s2"> elements&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">print_list_structure</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  &quot;</span> <span class="o">*</span> <span class="n">level</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;Level </span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">lst</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">OligoPool</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">oligo</span> <span class="ow">in</span> <span class="n">lst</span><span class="o">.</span><span class="n">pool</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  &quot;</span> <span class="o">*</span> <span class="n">level</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;Level </span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">oligo</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">oligo</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>



    <span class="k">def</span><span class="w"> </span><span class="nf">process_tuple_list</span><span class="p">(</span><span class="n">tuple_list</span><span class="p">):</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">flip_tuple</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">t</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Ensure the tuple containing &#39;A&#39; is the first tuple</span>
        <span class="k">if</span> <span class="s1">&#39;A&#39;</span> <span class="o">==</span> <span class="n">tuple_list</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="s1">&#39;A&#39;</span> <span class="o">==</span> <span class="n">tuple_list</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">tuple_list</span> <span class="o">=</span> <span class="p">(</span><span class="n">tuple_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">tuple_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Ensure &#39;A&#39; is the first entry of the first tuple</span>
        <span class="k">if</span> <span class="n">tuple_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span>
            <span class="n">tuple_list</span> <span class="o">=</span> <span class="p">(</span><span class="n">flip_tuple</span><span class="p">(</span><span class="n">tuple_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">flip_tuple</span><span class="p">(</span><span class="n">tuple_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">tuple_list</span>


    <span class="c1"># def add_empty_to_innermost(self, lst, library):</span>
    <span class="c1">#     if isinstance(lst, list):</span>
    <span class="c1">#         if all( isinstance(i, Oligo) for i in lst):</span>
    <span class="c1">#             testvar = [[Oligo([complement(lst[0].motifs[0],library.dictmotives), &#39;empty&#39;]), lst[0]], lst[1]]</span>
    <span class="c1">#             # print(testvar)</span>
    <span class="c1">#             # breakpoint()</span>
    <span class="c1">#             return [[Oligo([complement(lst[0].motifs[0],library.dictmotives), &#39;empty&#39;]), lst[0]], lst[1]]</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             return [self.add_empty_to_innermost(i,library) for i in lst]</span>
    <span class="c1">#     return lst</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_empty_to_innermost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lst</span><span class="p">,</span> <span class="n">library</span><span class="p">):</span>
        <span class="n">finishedlist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">finishedlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Oligo</span><span class="p">([</span><span class="n">complement</span><span class="p">(</span><span class="n">lst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">motifs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">library</span><span class="o">.</span><span class="n">dictmotives</span><span class="p">),</span> <span class="s1">&#39;empty&#39;</span><span class="p">]))</span>
        <span class="n">finishedlist</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">finishedlist</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_nested_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nested_list</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">print_nested_list</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">,</span>  <span class="s1">&#39;oligo&#39;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">nest_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lst</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursively nests a list into the structure [[[[a, b], c], d], e].</span>

<span class="sd">        Args:</span>
<span class="sd">            lst (list): The input list to be nested.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: The nested list structure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">lst</span>  <span class="c1"># Base case: if the list has 1 or fewer elements, return it as is</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nest_list</span><span class="p">(</span><span class="n">lst</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">lst</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>  <span class="c1"># Recursively nest all but the last element with the last element</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoded_data</span><span class="p">):</span>

        <span class="n">assembled_data</span> <span class="o">=</span> <span class="n">AssembledData</span><span class="p">(</span><span class="n">encoded_data</span><span class="p">)</span>
        <span class="n">assembled_data</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">encoded_data</span><span class="p">,</span> <span class="n">EncodedData</span><span class="p">):</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;synthesis&#39;</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">synthesis_method</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">encoded_data</span><span class="o">.</span><span class="n">data</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">synthesis_method</span> <span class="o">==</span> <span class="s1">&#39;nosynthpoly&#39;</span><span class="p">:</span>
                    <span class="n">sequences_multiples</span> <span class="o">=</span> <span class="p">[</span><span class="n">seq</span> <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="n">encoded_data</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span><span class="p">))))]</span>
                    <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">sequences_multiples</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">synthesized_data</span> <span class="o">=</span> <span class="n">synthesis_simulation</span><span class="p">(</span><span class="n">encoded_data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">method_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">synthesis_method</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span><span class="p">)</span>
                    <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">synthesized_data</span>

            <span class="c1"># linear assembly / linear encoding</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span> <span class="ow">and</span>  <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">:</span>

                <span class="n">restructuredlib</span> <span class="o">=</span> <span class="n">translate_nested_list</span><span class="p">(</span><span class="n">encoded_data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">translationlibleft</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">translationlibright</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theory</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
                    <span class="n">poolingfinish</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_function_repeatedly_therory</span><span class="p">(</span><span class="n">restructuredlib</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="p">,</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">)</span>
                    <span class="n">retranslated</span> <span class="o">=</span> <span class="n">back_translate_nested_list_chain</span><span class="p">(</span><span class="n">poolingfinish</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">translationlibleft</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">translationlibright</span><span class="p">)</span>
                    <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">retranslated</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theory</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
                    <span class="n">empyrestructuredlib</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">restructuredlib</span><span class="p">)):</span>
                        <span class="n">empyrestructuredlib</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nest_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_empty_to_innermost</span><span class="p">(</span><span class="n">restructuredlib</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="p">)))</span>

                    <span class="n">poolingfinish</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_function_repeatedly</span><span class="p">(</span><span class="n">empyrestructuredlib</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="p">,</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">)</span>
                    <span class="n">poolingfinish</span> <span class="o">=</span> <span class="n">flatten_at_layer</span><span class="p">(</span><span class="n">poolingfinish</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">poolingfinish</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">poolingfinish</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">retranslated</span> <span class="o">=</span> <span class="n">back_translate_nested_list_chain_real</span><span class="p">(</span><span class="n">poolingfinish</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">translationlibleft</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">translationlibright</span><span class="p">)</span>
                    <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">retranslated</span>

            <span class="c1"># linear assembly / binomial encoding</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span> <span class="ow">and</span>  <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>

                <span class="n">restructuredlib</span> <span class="o">=</span> <span class="n">translate_nested_list</span><span class="p">(</span><span class="n">encoded_data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">translationlibleft</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">translationlibright</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theory</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
                    <span class="n">poolingfinish</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_function_repeatedly_therory</span><span class="p">(</span><span class="n">restructuredlib</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="p">,</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">)</span>
                    <span class="n">retranslated</span> <span class="o">=</span> <span class="n">back_translate_nested_list</span><span class="p">(</span><span class="n">poolingfinish</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">translationlibleft</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">translationlibright</span><span class="p">)</span>
                    <span class="n">retranslated</span> <span class="o">=</span> <span class="n">flatten_at_layer</span><span class="p">(</span><span class="n">retranslated</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">retranslated</span>

                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">theory</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
                    <span class="n">poolingfinish</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_function_repeatedly</span><span class="p">(</span><span class="n">restructuredlib</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="p">,</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">)</span>
                    <span class="n">retranslated</span> <span class="o">=</span> <span class="n">back_translate_nested_list_real</span><span class="p">(</span><span class="n">poolingfinish</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">translationlibleft</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="o">.</span><span class="n">translationlibright</span><span class="p">)</span>
                    <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">retranslated</span>

            <span class="c1"># positional assembly / linear encoding</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">:</span>
                <span class="n">restructuredlib</span> <span class="o">=</span> <span class="n">translate_nested_list_poly</span><span class="p">(</span><span class="n">encoded_data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theory</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
                    <span class="n">poolingfinish</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_function_repeatedly</span><span class="p">(</span><span class="n">restructuredlib</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="p">,</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">)</span>
                    <span class="n">retranslated</span> <span class="o">=</span> <span class="n">back_translate_nested_list_poly</span><span class="p">(</span><span class="n">poolingfinish</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="p">)</span>
                    <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">retranslated</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theory</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
                    <span class="n">poolingfinish</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_function_repeatedly</span><span class="p">(</span><span class="n">restructuredlib</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="p">,</span> <span class="s1">&#39;linear_encoding&#39;</span><span class="p">)</span>
                    <span class="n">retranslated</span> <span class="o">=</span> <span class="n">back_translate_nested_list_poly_binom_real</span><span class="p">(</span><span class="n">poolingfinish</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="p">)</span>
                    <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">retranslated</span>

            <span class="c1"># positional assembly / binomial encoding</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">assembly_structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoding_scheme</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">:</span>
                <span class="n">restructuredlib</span> <span class="o">=</span> <span class="n">translate_nested_list_poly</span><span class="p">(</span><span class="n">encoded_data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">theory</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
                    <span class="n">poolingfinish</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_function_repeatedly_therory</span><span class="p">(</span><span class="n">restructuredlib</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="p">,</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">)</span>

                    <span class="n">retranslated</span> <span class="o">=</span> <span class="n">back_translate_nested_list_poly_binom</span><span class="p">(</span><span class="n">poolingfinish</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="p">)</span>
                    <span class="n">retranslated</span> <span class="o">=</span> <span class="n">flatten_at_layer</span><span class="p">(</span><span class="n">retranslated</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">retranslated</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">theory</span> <span class="o">==</span> <span class="s1">&#39;no&#39;</span><span class="p">:</span>
                    <span class="n">poolingfinish</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">call_function_repeatedly</span><span class="p">(</span><span class="n">restructuredlib</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="p">,</span> <span class="s1">&#39;binomial_encoding&#39;</span><span class="p">)</span>

                    <span class="n">retranslated</span> <span class="o">=</span> <span class="n">back_translate_nested_list_poly_binom_real</span><span class="p">(</span><span class="n">poolingfinish</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">library</span><span class="p">)</span>
                    <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">retranslated</span>

            <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">return</span> <span class="n">assembled_data</span><span class="p">,</span> <span class="n">info</span>

        <span class="k">else</span><span class="p">:</span> 
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Data object is not supported.&quot;</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">substitute_tuples_with_oligos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nested_list</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Oligo</span><span class="p">(</span><span class="n">motifs</span><span class="o">=</span><span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substitute_tuples_with_oligos</span><span class="p">(</span><span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid data structure.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nested_list</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">recursive_assembly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nested_list</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="p">,</span> <span class="n">hybridisation_steps</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursively assemble the data using the pool of oligos.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">):</span>
                <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">(</span><span class="n">oligo_list</span><span class="o">=</span><span class="n">nested_list</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span><span class="p">)</span>
                <span class="n">combined_pool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="n">hybridisation_steps</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">combined_pool</span>

            <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">OligoPool</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">):</span>
                <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nested_list</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span><span class="p">)</span>
                <span class="n">combined_pool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="n">hybridisation_steps</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">combined_pool</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly</span><span class="p">(</span><span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="p">,</span> <span class="n">hybridisation_steps</span><span class="p">)</span>

                <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">nested_list</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="n">std_dev</span><span class="p">)</span>
                <span class="n">combined_pool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="n">hybridisation_steps</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">combined_pool</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">find_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nested_list</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nested_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">nested_list</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">find_depth</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">call_function_repeatedly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">,</span><span class="n">encoding</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">encoding</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span> <span class="ow">and</span> <span class="n">library</span><span class="o">.</span><span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span><span class="p">:</span>

            <span class="n">polypooling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_theoretical_withmean</span><span class="p">(</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>


            <span class="n">times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_depth</span><span class="p">(</span><span class="n">polypooling</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
                <span class="n">polypooling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_messy_randompairing</span><span class="p">(</span><span class="n">polypooling</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>


        <span class="k">elif</span> <span class="n">encoding</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span> <span class="ow">and</span> <span class="n">library</span><span class="o">.</span><span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;positional_assembly&#39;</span><span class="p">:</span>
            <span class="n">polypooling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_theoretical_withmean</span><span class="p">(</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>

            <span class="n">times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_depth</span><span class="p">(</span><span class="n">polypooling</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
                <span class="n">polypooling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_messy_randompairing</span><span class="p">(</span><span class="n">polypooling</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">encoding</span> <span class="o">==</span> <span class="s1">&#39;binomial_encoding&#39;</span> <span class="ow">and</span> <span class="n">library</span><span class="o">.</span><span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span><span class="p">:</span>
            <span class="n">times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_depth</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span>

            <span class="n">polypooling</span> <span class="o">=</span> <span class="n">nested_list</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
                <span class="n">polypooling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_messy_randompairing</span><span class="p">(</span><span class="n">polypooling</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">encoding</span> <span class="o">==</span> <span class="s1">&#39;linear_encoding&#39;</span> <span class="ow">and</span> <span class="n">library</span><span class="o">.</span><span class="n">structure</span> <span class="o">==</span> <span class="s1">&#39;linear_assembly&#39;</span><span class="p">:</span>

            <span class="n">times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_depth</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span>
            <span class="n">polypooling</span> <span class="o">=</span> <span class="n">nested_list</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">polypooling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_messy_randompairing</span><span class="p">(</span><span class="n">polypooling</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">polypooling</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">recursive_assembly_messy_randompairing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">):</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span> <span class="k">for</span> <span class="n">subitem</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">nested_list</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span><span class="p">)</span>

            <span class="n">tester</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">checkup</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">newoligos</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">looping</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">while</span> <span class="n">looping</span><span class="p">:</span>
                <span class="n">leftends</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">rightends</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">if</span> <span class="n">newoligos</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">newoligos</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span>  <span class="nb">len</span><span class="p">(</span><span class="n">combined_pool</span><span class="o">.</span><span class="n">pool</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">break</span>

                <span class="n">newoligos</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">combined_pool</span><span class="o">.</span><span class="n">pool</span><span class="p">)):</span>

                    <span class="n">allinpool</span> <span class="o">=</span> <span class="n">combined_pool</span><span class="o">.</span><span class="n">pool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">allends</span> <span class="o">=</span> <span class="p">[</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">)]</span>
                    <span class="n">allvelidends</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">allends</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

                    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">allvelidends</span><span class="p">:</span>
                        <span class="n">leftends</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">item</span><span class="p">])</span>
                    <span class="n">newoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">allinpool</span><span class="p">)</span>

                <span class="n">leftends</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">leftends</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">leftends</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">leftends</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

                <span class="n">tester</span> <span class="o">=+</span> <span class="mi">1</span>
                <span class="n">motivrcounter</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkup</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">findingmotive</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">if</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span>
                    <span class="n">motivrcounter</span><span class="o">+=</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">while</span> <span class="n">findingmotive</span> <span class="ow">in</span> <span class="n">checkup</span><span class="p">:</span>

                        <span class="n">findingmotive</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">motivrcounter</span><span class="o">+=</span><span class="mi">1</span>

                        <span class="k">if</span> <span class="n">motivrcounter</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">leftends</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>

                            <span class="n">looping</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="n">motivrcounter</span> <span class="o">=-</span><span class="mi">1</span>
                            <span class="k">break</span>
                    <span class="n">motivrcounter</span><span class="o">-=</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>  
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span>
                    <span class="n">motivrcounter</span><span class="o">+=</span><span class="mi">1</span>
                <span class="n">sublist1</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">sublist2</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">leftends</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">findingmotive</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">):</span>
                        <span class="n">sublist1</span> <span class="o">=</span> <span class="n">sublist</span>
                    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">findingmotivecomp</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">):</span>
                        <span class="n">sublist2</span> <span class="o">=</span> <span class="n">sublist</span>   

                <span class="k">if</span> <span class="n">sublist1</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">lensublist1</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lensublist1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublist1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">sublist2</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">lensublist2</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lensublist2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublist2</span><span class="p">)</span>
                    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sublist2</span><span class="p">)</span>

                <span class="n">newoligosupdated</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">deletableoligos</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">lensublist1</span><span class="p">,</span><span class="n">lensublist2</span><span class="p">)):</span>

                    <span class="n">temp_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist1</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist2</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]]])</span>
                    <span class="n">deletableoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist1</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
                    <span class="n">deletableoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist2</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
                    <span class="n">newoligotoadd</span> <span class="o">=</span> <span class="n">temp_pool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
                    <span class="n">newoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newoligotoadd</span><span class="p">)</span>

                <span class="n">elements_count</span> <span class="o">=</span> <span class="p">{</span><span class="n">element</span><span class="p">:</span> <span class="n">deletableoligos</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">deletableoligos</span><span class="p">)}</span>

                <span class="n">result_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">newoligos</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">elements_count</span> <span class="ow">and</span> <span class="n">elements_count</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">elements_count</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">result_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">newoligos</span> <span class="o">=</span> <span class="n">result_list</span>

            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">newoligos</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">combined_pool</span>

        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">OligoPool</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span>  <span class="k">for</span> <span class="n">subitem</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">)</span>  <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">nested_list</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span><span class="p">)</span>
            <span class="n">tester</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">checkup</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">newoligos</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">looping</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">while</span> <span class="n">looping</span><span class="p">:</span>
                <span class="n">leftends</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">rightends</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">newoligos</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">newoligos</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

                <span class="n">newoligos</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">combined_pool</span><span class="o">.</span><span class="n">pool</span><span class="p">)):</span>

                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">combined_pool</span><span class="o">.</span><span class="n">pool</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">OligoPool</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">allinpool</span> <span class="ow">in</span> <span class="n">combined_pool</span><span class="o">.</span><span class="n">pool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pool</span><span class="p">:</span>
                            <span class="n">allends</span> <span class="o">=</span> <span class="p">[</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">)]</span>
                            <span class="n">allvelidends</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">allends</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>

                            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">allvelidends</span><span class="p">:</span>
                                <span class="n">leftends</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">item</span><span class="p">])</span>

                            <span class="n">newoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">allinpool</span><span class="p">)</span>


                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">allinpool</span> <span class="o">=</span> <span class="n">combined_pool</span><span class="o">.</span><span class="n">pool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">allends</span> <span class="o">=</span> <span class="p">[</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">)]</span>
                        <span class="n">allvelidends</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">allends</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">allvelidends</span><span class="p">:</span>
                            <span class="n">leftends</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">item</span><span class="p">])</span>
                        <span class="n">newoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">allinpool</span><span class="p">)</span>

                <span class="n">leftends</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">leftends</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">leftends</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">leftends</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

                <span class="n">tester</span> <span class="o">=+</span> <span class="mi">1</span>
                <span class="n">motivrcounter</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkup</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">findingmotive</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">if</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span>
                    <span class="n">motivrcounter</span><span class="o">+=</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">while</span> <span class="n">findingmotive</span> <span class="ow">in</span> <span class="n">checkup</span><span class="p">:</span>

                        <span class="n">findingmotive</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">motivrcounter</span><span class="o">+=</span><span class="mi">1</span>

                        <span class="k">if</span> <span class="n">motivrcounter</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">leftends</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>

                            <span class="n">looping</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="n">motivrcounter</span> <span class="o">=-</span><span class="mi">1</span>
                            <span class="k">break</span>
                    <span class="n">motivrcounter</span><span class="o">-=</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>  
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span>
                    <span class="n">motivrcounter</span><span class="o">+=</span><span class="mi">1</span>
                <span class="n">sublist1</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">sublist2</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">leftends</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">findingmotive</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">):</span>
                        <span class="n">sublist1</span> <span class="o">=</span> <span class="n">sublist</span>
                    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">findingmotivecomp</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">):</span>
                        <span class="n">sublist2</span> <span class="o">=</span> <span class="n">sublist</span>   

                <span class="k">if</span> <span class="n">sublist1</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">lensublist1</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lensublist1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublist1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">sublist2</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">lensublist2</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lensublist2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublist2</span><span class="p">)</span>
                    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sublist2</span><span class="p">)</span>

                <span class="n">newoligosupdated</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">deletableoligos</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">lensublist1</span><span class="p">,</span><span class="n">lensublist2</span><span class="p">)):</span>

                    <span class="n">temp_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist1</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist2</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]]])</span>
                    <span class="n">deletableoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist1</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
                    <span class="n">deletableoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist2</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
                    <span class="n">newoligotoadd</span> <span class="o">=</span> <span class="n">temp_pool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
                    <span class="n">newoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newoligotoadd</span><span class="p">)</span>

                <span class="n">elements_count</span> <span class="o">=</span> <span class="p">{</span><span class="n">element</span><span class="p">:</span> <span class="n">deletableoligos</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">deletableoligos</span><span class="p">)}</span>

                <span class="n">result_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">newoligos</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">elements_count</span> <span class="ow">and</span> <span class="n">elements_count</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">elements_count</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">result_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">newoligos</span> <span class="o">=</span> <span class="n">result_list</span>

            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">newoligos</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">combined_pool</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">nested_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_messy_randompairing</span><span class="p">(</span><span class="n">subelement</span><span class="p">,</span><span class="n">library</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subelement</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">subelement</span> <span class="k">for</span> <span class="n">subelement</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">]</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">recursive_assembly_messy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">):</span>
        <span class="n">counter</span><span class="o">=</span><span class="mi">0</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span> <span class="k">for</span> <span class="n">subitem</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">(</span><span class="n">oligo_list</span><span class="o">=</span><span class="n">nested_list</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span><span class="p">)</span>
            <span class="n">combined_pool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hybridisation_steps</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">combined_pool</span>

        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">OligoPool</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span>  <span class="k">for</span> <span class="n">subitem</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">)</span>  <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">nested_list</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span><span class="p">)</span>
            <span class="n">combined_pool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hybridisation_steps</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">combined_pool</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">nested_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_messy</span><span class="p">(</span><span class="n">subelement</span><span class="p">,</span><span class="n">library</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subelement</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">subelement</span> <span class="k">for</span> <span class="n">subelement</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">]</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">call_function_repeatedly_therory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">,</span><span class="n">encoding</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls the target function the specified number of times.</span>

<span class="sd">        :param target_function: The function to be called repeatedly.</span>
<span class="sd">        :param times: The number of times to call the function.</span>
<span class="sd">        :param args: Positional arguments to pass to the target function.</span>
<span class="sd">        :param kwargs: Keyword arguments to pass to the target function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">times</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">find_depth</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">encoding</span><span class="o">==</span><span class="s1">&#39;linear_encoding&#39;</span> <span class="ow">and</span> <span class="n">library</span><span class="o">.</span><span class="n">structure</span><span class="o">==</span><span class="s2">&quot;linear_assembly&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>

                <span class="n">nested_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_chain_theoretical</span><span class="p">(</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">encoding</span><span class="o">==</span><span class="s1">&#39;binomial_encoding&#39;</span> <span class="ow">and</span> <span class="n">library</span><span class="o">.</span><span class="n">structure</span><span class="o">==</span><span class="s2">&quot;linear_assembly&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>

                <span class="n">nested_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_theoretical</span><span class="p">(</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">encoding</span><span class="o">==</span><span class="s1">&#39;linear_encoding&#39;</span> <span class="ow">and</span> <span class="n">library</span><span class="o">.</span><span class="n">structure</span><span class="o">==</span><span class="s2">&quot;positional_assembly&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>

                <span class="n">nested_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_theoretical</span><span class="p">(</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="n">encoding</span><span class="o">==</span><span class="s1">&#39;binomial_encoding&#39;</span> <span class="ow">and</span> <span class="n">library</span><span class="o">.</span><span class="n">structure</span><span class="o">==</span><span class="s2">&quot;positional_assembly&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">nested_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_theoretical</span><span class="p">(</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">nested_list</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">recursive_assembly_theoretical_withmean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">,</span><span class="n">mean</span><span class="p">):</span>
        <span class="n">counter</span><span class="o">=</span><span class="mi">0</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span> <span class="k">for</span> <span class="n">subitem</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>

            <span class="n">alloligos</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">mean</span><span class="p">)):</span>
                <span class="n">hybridized</span><span class="o">=</span><span class="n">nested_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">hybridizationpool</span><span class="o">=</span><span class="n">OligoPool</span><span class="p">([</span><span class="n">hybridized</span><span class="p">,</span><span class="n">nested_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
                <span class="n">hybridized</span><span class="o">=</span><span class="n">hybridizationpool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
                    <span class="n">hybridizationpool</span><span class="o">=</span><span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">hybridized</span><span class="p">,</span><span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]],</span><span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

                    <span class="n">hybridized</span><span class="o">=</span><span class="n">hybridizationpool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
                <span class="n">alloligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hybridized</span><span class="p">)</span>
            <span class="n">hybridizedpool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">(</span><span class="n">alloligos</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">hybridizedpool</span>

        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">OligoPool</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span>  <span class="k">for</span> <span class="n">subitem</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">)</span>  <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">hybridized</span><span class="o">=</span><span class="n">nested_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">hybridized</span><span class="p">,</span><span class="n">nested_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">hybridized</span><span class="o">=</span><span class="n">combined_pool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">hybridizationpool</span><span class="o">=</span><span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">hybridized</span><span class="p">,</span><span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]],</span> <span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">hybridized</span><span class="o">=</span><span class="n">hybridizationpool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">hybridized</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">nested_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>


            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_theoretical_withmean</span><span class="p">(</span><span class="n">subelement</span><span class="p">,</span><span class="n">library</span><span class="p">,</span><span class="n">mean</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subelement</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">subelement</span> <span class="k">for</span> <span class="n">subelement</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">]</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">recursive_assembly_theoretical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">):</span>
        <span class="n">counter</span><span class="o">=</span><span class="mi">0</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span> <span class="k">for</span> <span class="n">subitem</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>

            <span class="n">hybridized</span><span class="o">=</span><span class="n">nested_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">hybridizationpool</span><span class="o">=</span><span class="n">OligoPool</span><span class="p">([</span><span class="n">hybridized</span><span class="p">,</span><span class="n">nested_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">hybridized</span><span class="o">=</span><span class="n">hybridizationpool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">hybridizationpool</span><span class="o">=</span><span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">hybridized</span><span class="p">,</span><span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]],</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

                <span class="n">hybridized</span><span class="o">=</span><span class="n">hybridizationpool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">counter</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>

                    <span class="n">counter</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">counter2</span><span class="o">=</span><span class="mi">0</span>

            <span class="k">return</span> <span class="n">hybridized</span>

        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">OligoPool</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span>  <span class="k">for</span> <span class="n">subitem</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">)</span>  <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>

            <span class="n">hybridized</span><span class="o">=</span><span class="n">nested_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">hybridized</span><span class="p">,</span><span class="n">nested_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">hybridized</span><span class="o">=</span><span class="n">combined_pool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">hybridizationpool</span><span class="o">=</span><span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">hybridized</span><span class="p">,</span><span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]],</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">hybridized</span><span class="o">=</span><span class="n">hybridizationpool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">hybridized</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">nested_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_theoretical</span><span class="p">(</span><span class="n">subelement</span><span class="p">,</span><span class="n">library</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subelement</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">subelement</span> <span class="k">for</span> <span class="n">subelement</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">]</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">recursive_assembly_chain_theoretical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">):</span>
        <span class="n">counter</span><span class="o">=</span><span class="mi">0</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span> <span class="k">for</span> <span class="n">subitem</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">):</span>

            <span class="n">hybridized</span><span class="o">=</span><span class="n">nested_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">endoligo</span> <span class="o">=</span> <span class="n">Oligo</span><span class="p">([</span><span class="n">complement</span><span class="p">(</span><span class="n">nested_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">motifs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">library</span><span class="o">.</span><span class="n">dictmotives</span><span class="p">),</span><span class="s1">&#39;empty&#39;</span><span class="p">])</span>

            <span class="n">hybridizedend</span><span class="o">=</span><span class="n">OligoPool</span><span class="p">([</span><span class="n">hybridized</span><span class="p">,</span><span class="n">endoligo</span><span class="p">])</span>
            <span class="n">hybridized</span><span class="o">=</span><span class="n">hybridizedend</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
            <span class="n">hybridizationpool</span><span class="o">=</span><span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">hybridized</span><span class="p">,</span><span class="n">nested_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">hybridized</span><span class="o">=</span><span class="n">hybridizationpool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">hybridizationpool</span><span class="o">=</span><span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">hybridized</span><span class="p">,</span><span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]],</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">hybridized</span><span class="o">=</span><span class="n">hybridizationpool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">counter</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>

                    <span class="n">counter</span><span class="o">+=</span><span class="mi">1</span>

            <span class="k">return</span> <span class="n">hybridized</span>

        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">OligoPool</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span>  <span class="k">for</span> <span class="n">subitem</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">):</span>
            <span class="n">hybridized</span><span class="o">=</span><span class="n">nested_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">hybridized</span><span class="p">,</span><span class="n">nested_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">hybridized</span><span class="o">=</span><span class="n">combined_pool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">hybridizationpool</span><span class="o">=</span><span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">hybridized</span><span class="p">,</span><span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]],</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">hybridized</span><span class="o">=</span><span class="n">hybridizationpool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">hybridized</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_chain_theoretical</span><span class="p">(</span><span class="n">subelement</span><span class="p">,</span><span class="n">library</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subelement</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">subelement</span> <span class="k">for</span> <span class="n">subelement</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">]</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">recursive_assembly_messy_randompairing_chain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span> <span class="k">for</span> <span class="n">subitem</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">nested_list</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span><span class="p">)</span>
            <span class="n">tester</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">checkup</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">newoligos</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">looping</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">while</span> <span class="n">looping</span><span class="p">:</span>
                <span class="n">leftends</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">rightends</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">newoligos</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">newoligos</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

                <span class="n">newoligos</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">combined_pool</span><span class="o">.</span><span class="n">pool</span><span class="p">)):</span>

                    <span class="c1"># else:</span>
                    <span class="n">allinpool</span> <span class="o">=</span> <span class="n">combined_pool</span><span class="o">.</span><span class="n">pool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">allends</span> <span class="o">=</span> <span class="p">[</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">)]</span>
                    <span class="n">allvelidends</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">allends</span> <span class="k">if</span> <span class="p">(</span><span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)]</span>
                    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">allvelidends</span><span class="p">:</span>
                        <span class="n">leftends</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">item</span><span class="p">])</span>
                    <span class="n">newoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">allinpool</span><span class="p">)</span>

                <span class="n">leftends</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">leftends</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">leftends</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">leftends</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>

                <span class="n">tester</span> <span class="o">=+</span> <span class="mi">1</span>
                <span class="n">motivrcounter</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkup</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">findingmotive</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">if</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span>
                    <span class="n">motivrcounter</span><span class="o">+=</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">while</span> <span class="n">findingmotive</span> <span class="ow">in</span> <span class="n">checkup</span><span class="p">:</span>

                        <span class="n">findingmotive</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">motivrcounter</span><span class="o">+=</span><span class="mi">1</span>

                        <span class="k">if</span> <span class="n">motivrcounter</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">leftends</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>

                            <span class="n">looping</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="n">motivrcounter</span> <span class="o">=-</span><span class="mi">1</span>
                            <span class="k">break</span>
                    <span class="n">motivrcounter</span><span class="o">-=</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>  
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span>
                    <span class="n">motivrcounter</span><span class="o">+=</span><span class="mi">1</span>
                <span class="n">sublist1</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">sublist2</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">leftends</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">findingmotive</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">):</span>
                        <span class="n">sublist1</span> <span class="o">=</span> <span class="n">sublist</span>
                    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">findingmotivecomp</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">):</span>
                        <span class="n">sublist2</span> <span class="o">=</span> <span class="n">sublist</span>   

                <span class="k">if</span> <span class="n">sublist1</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">lensublist1</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lensublist1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublist1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">sublist2</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">lensublist2</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lensublist2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublist2</span><span class="p">)</span>
                    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sublist2</span><span class="p">)</span>

                <span class="n">newoligosupdated</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">deletableoligos</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">lensublist1</span><span class="p">,</span><span class="n">lensublist2</span><span class="p">)):</span>

                    <span class="n">temp_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist1</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist2</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]]])</span>
                    <span class="n">deletableoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist1</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
                    <span class="n">deletableoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist2</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
                    <span class="n">newoligotoadd</span> <span class="o">=</span> <span class="n">temp_pool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
                    <span class="n">newoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newoligotoadd</span><span class="p">)</span>

                <span class="n">elements_count</span> <span class="o">=</span> <span class="p">{</span><span class="n">element</span><span class="p">:</span> <span class="n">deletableoligos</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">deletableoligos</span><span class="p">)}</span>

                <span class="n">result_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">newoligos</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">elements_count</span> <span class="ow">and</span> <span class="n">elements_count</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">elements_count</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">result_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">newoligos</span> <span class="o">=</span> <span class="n">result_list</span>

            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">newoligos</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">combined_pool</span>

        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">OligoPool</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subitem</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span>  <span class="k">for</span> <span class="n">subitem</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">)</span>  <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">nested_list</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span><span class="p">)</span>
            <span class="n">tester</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">checkup</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">newoligos</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">looping</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">while</span> <span class="n">looping</span><span class="p">:</span>
                <span class="n">leftends</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">rightends</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">newoligos</span> <span class="o">!=</span> <span class="p">[]:</span>
                    <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">newoligos</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

                <span class="n">newoligos</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">combined_pool</span><span class="o">.</span><span class="n">pool</span><span class="p">)):</span>

                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">combined_pool</span><span class="o">.</span><span class="n">pool</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">OligoPool</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">allinpool</span> <span class="ow">in</span> <span class="n">combined_pool</span><span class="o">.</span><span class="n">pool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pool</span><span class="p">:</span>
                            <span class="n">allends</span> <span class="o">=</span> <span class="p">[</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">)]</span>
                            <span class="n">allvelidends</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">allends</span> <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
                            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">allvelidends</span><span class="p">:</span>
                                <span class="n">leftends</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">item</span><span class="p">])</span>

                            <span class="n">newoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">allinpool</span><span class="p">)</span>


                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">allinpool</span> <span class="o">=</span> <span class="n">combined_pool</span><span class="o">.</span><span class="n">pool</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">allends</span> <span class="o">=</span> <span class="p">[</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">),</span><span class="n">allinpool</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">)]</span>

                        <span class="n">allvelidends</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">allends</span> <span class="k">if</span> <span class="p">(</span><span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)]</span>
                        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">allvelidends</span><span class="p">:</span>
                            <span class="n">leftends</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">item</span><span class="p">])</span>
                        <span class="n">newoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">allinpool</span><span class="p">)</span>

                <span class="n">leftends</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">leftends</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">leftends</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">leftends</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                <span class="n">tester</span> <span class="o">=+</span> <span class="mi">1</span>
                <span class="n">motivrcounter</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">checkup</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">findingmotive</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">if</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span>
                    <span class="n">motivrcounter</span><span class="o">+=</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">while</span> <span class="n">findingmotive</span> <span class="ow">in</span> <span class="n">checkup</span><span class="p">:</span>

                        <span class="n">findingmotive</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">motivrcounter</span><span class="o">+=</span><span class="mi">1</span>

                        <span class="k">if</span> <span class="n">motivrcounter</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">leftends</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>

                            <span class="n">looping</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="n">motivrcounter</span> <span class="o">=-</span><span class="mi">1</span>
                            <span class="k">break</span>
                    <span class="n">motivrcounter</span><span class="o">-=</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>  
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">checkup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
                        <span class="n">findingmotivecomp</span> <span class="o">=</span> <span class="n">leftends</span><span class="p">[</span><span class="n">motivrcounter</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*&#39;</span>
                    <span class="n">motivrcounter</span><span class="o">+=</span><span class="mi">1</span>
                <span class="n">sublist1</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">sublist2</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">leftends</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">findingmotive</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">):</span>
                        <span class="n">sublist1</span> <span class="o">=</span> <span class="n">sublist</span>
                    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">findingmotivecomp</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">):</span>
                        <span class="n">sublist2</span> <span class="o">=</span> <span class="n">sublist</span>   

                <span class="k">if</span> <span class="n">sublist1</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">lensublist1</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lensublist1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublist1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">sublist2</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">lensublist2</span><span class="o">=</span><span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lensublist2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sublist2</span><span class="p">)</span>
                    <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sublist2</span><span class="p">)</span>

                <span class="n">newoligosupdated</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">deletableoligos</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">lensublist1</span><span class="p">,</span><span class="n">lensublist2</span><span class="p">)):</span>

                    <span class="n">temp_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist1</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist2</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]]])</span>
                    <span class="n">deletableoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist1</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
                    <span class="n">deletableoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newoligos</span><span class="p">[</span><span class="n">sublist2</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
                    <span class="n">newoligotoadd</span> <span class="o">=</span> <span class="n">temp_pool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>
                    <span class="n">newoligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newoligotoadd</span><span class="p">)</span>

                <span class="n">elements_count</span> <span class="o">=</span> <span class="p">{</span><span class="n">element</span><span class="p">:</span> <span class="n">deletableoligos</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">deletableoligos</span><span class="p">)}</span>

                <span class="n">result_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">newoligos</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">elements_count</span> <span class="ow">and</span> <span class="n">elements_count</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">elements_count</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">result_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                <span class="n">newoligos</span> <span class="o">=</span> <span class="n">result_list</span>

            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">newoligos</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">combined_pool</span>

        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">nested_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_messy_randompairing_chain</span><span class="p">(</span><span class="n">subelement</span><span class="p">,</span><span class="n">library</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subelement</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">subelement</span> <span class="k">for</span> <span class="n">subelement</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="dnabyte.assembly.SimulateAssembly.call_function_repeatedly_therory" class="doc doc-heading">
            <code class=" language-python"><span class="n">call_function_repeatedly_therory</span><span class="p">(</span><span class="n">nested_list</span><span class="p">,</span> <span class="n">library</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span></code>

<a href="#dnabyte.assembly.SimulateAssembly.call_function_repeatedly_therory" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Calls the target function the specified number of times.</p>
<p>:param target_function: The function to be called repeatedly.
:param times: The number of times to call the function.
:param args: Positional arguments to pass to the target function.
:param kwargs: Keyword arguments to pass to the target function.</p>


            <details class="quote">
              <summary>Source code in <code>dnabyte/assembly.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">call_function_repeatedly_therory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">,</span><span class="n">encoding</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calls the target function the specified number of times.</span>

<span class="sd">    :param target_function: The function to be called repeatedly.</span>
<span class="sd">    :param times: The number of times to call the function.</span>
<span class="sd">    :param args: Positional arguments to pass to the target function.</span>
<span class="sd">    :param kwargs: Keyword arguments to pass to the target function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">times</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">find_depth</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">encoding</span><span class="o">==</span><span class="s1">&#39;linear_encoding&#39;</span> <span class="ow">and</span> <span class="n">library</span><span class="o">.</span><span class="n">structure</span><span class="o">==</span><span class="s2">&quot;linear_assembly&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>

            <span class="n">nested_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_chain_theoretical</span><span class="p">(</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">encoding</span><span class="o">==</span><span class="s1">&#39;binomial_encoding&#39;</span> <span class="ow">and</span> <span class="n">library</span><span class="o">.</span><span class="n">structure</span><span class="o">==</span><span class="s2">&quot;linear_assembly&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>

            <span class="n">nested_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_theoretical</span><span class="p">(</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">encoding</span><span class="o">==</span><span class="s1">&#39;linear_encoding&#39;</span> <span class="ow">and</span> <span class="n">library</span><span class="o">.</span><span class="n">structure</span><span class="o">==</span><span class="s2">&quot;positional_assembly&quot;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>

            <span class="n">nested_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_theoretical</span><span class="p">(</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">encoding</span><span class="o">==</span><span class="s1">&#39;binomial_encoding&#39;</span> <span class="ow">and</span> <span class="n">library</span><span class="o">.</span><span class="n">structure</span><span class="o">==</span><span class="s2">&quot;positional_assembly&quot;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">nested_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly_theoretical</span><span class="p">(</span><span class="n">nested_list</span><span class="p">,</span><span class="n">library</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">nested_list</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dnabyte.assembly.SimulateAssembly.nest_list" class="doc doc-heading">
            <code class=" language-python"><span class="n">nest_list</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span></code>

<a href="#dnabyte.assembly.SimulateAssembly.nest_list" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Recursively nests a list into the structure [[[[a, b], c], d], e].</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lst</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input list to be nested.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The nested list structure.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>dnabyte/assembly.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">nest_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lst</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Recursively nests a list into the structure [[[[a, b], c], d], e].</span>

<span class="sd">    Args:</span>
<span class="sd">        lst (list): The input list to be nested.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: The nested list structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">lst</span>  <span class="c1"># Base case: if the list has 1 or fewer elements, return it as is</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nest_list</span><span class="p">(</span><span class="n">lst</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">lst</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>  <span class="c1"># Recursively nest all but the last element with the last element</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dnabyte.assembly.SimulateAssembly.print_list_structure" class="doc doc-heading">
            <code class=" language-python"><span class="n">print_list_structure</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#dnabyte.assembly.SimulateAssembly.print_list_structure" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Recursively prints the structure of a list of lists.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lst</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The list to analyze.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>level</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current nesting level (used for indentation).</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>dnabyte/assembly.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">print_list_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lst</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Recursively prints the structure of a list of lists.</span>

<span class="sd">    Args:</span>
<span class="sd">        lst (list): The list to analyze.</span>
<span class="sd">        level (int): The current nesting level (used for indentation).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  &quot;</span> <span class="o">*</span> <span class="n">level</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;Level </span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">: List with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span><span class="si">}</span><span class="s2"> elements&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">print_list_structure</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  &quot;</span> <span class="o">*</span> <span class="n">level</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;Level </span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">lst</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">OligoPool</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">oligo</span> <span class="ow">in</span> <span class="n">lst</span><span class="o">.</span><span class="n">pool</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  &quot;</span> <span class="o">*</span> <span class="n">level</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;Level </span><span class="si">{</span><span class="n">level</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">oligo</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">oligo</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dnabyte.assembly.SimulateAssembly.recursive_assembly" class="doc doc-heading">
            <code class=" language-python"><span class="n">recursive_assembly</span><span class="p">(</span><span class="n">nested_list</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="p">,</span> <span class="n">hybridisation_steps</span><span class="p">)</span></code>

<a href="#dnabyte.assembly.SimulateAssembly.recursive_assembly" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Recursively assemble the data using the pool of oligos.</p>


            <details class="quote">
              <summary>Source code in <code>dnabyte/assembly.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">recursive_assembly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nested_list</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="p">,</span> <span class="n">hybridisation_steps</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Recursively assemble the data using the pool of oligos.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">):</span>
            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">(</span><span class="n">oligo_list</span><span class="o">=</span><span class="n">nested_list</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span><span class="p">)</span>
            <span class="n">combined_pool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="n">hybridisation_steps</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">combined_pool</span>

        <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">OligoPool</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">Oligo</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">):</span>
            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nested_list</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">std_dev</span><span class="p">)</span>
            <span class="n">combined_pool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="n">hybridisation_steps</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">combined_pool</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nested_list</span><span class="p">)):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recursive_assembly</span><span class="p">(</span><span class="n">nested_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="p">,</span> <span class="n">hybridisation_steps</span><span class="p">)</span>

            <span class="n">combined_pool</span> <span class="o">=</span> <span class="n">OligoPool</span><span class="p">([])</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pools</span><span class="o">=</span><span class="n">nested_list</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="n">std_dev</span><span class="p">)</span>
            <span class="n">combined_pool</span><span class="o">.</span><span class="n">hybridise</span><span class="p">(</span><span class="n">hybridisation_steps</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">combined_pool</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="dnabyte.storage"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="dnabyte.storage.SimulateStorage" class="doc doc-heading">
            <code>SimulateStorage</code>


<a href="#dnabyte.storage.SimulateStorage" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Simulate storage of DNA sequences in a storage medium.</p>
<p>The class consists of a constructor, which sets the parameters of the storage simulation, 
and a simulate method, which applies the simulation to an object of the AssembledData class.</p>
<p>:param years: The number of years for which DNA storage is supposed to be simulated. (0 to perform no simulation)
:param storage_conditions: A string 'permafrost', or 'room_temperature', or 'biogene'. (None to perform no simulation)</p>







              <details class="quote">
                <summary>Source code in <code>dnabyte/storage.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SimulateStorage</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate storage of DNA sequences in a storage medium.</span>

<span class="sd">    The class consists of a constructor, which sets the parameters of the storage simulation, </span>
<span class="sd">    and a simulate method, which applies the simulation to an object of the AssembledData class.</span>

<span class="sd">    :param years: The number of years for which DNA storage is supposed to be simulated. (0 to perform no simulation)</span>
<span class="sd">    :param storage_conditions: A string &#39;permafrost&#39;, or &#39;room_temperature&#39;, or &#39;biogene&#39;. (None to perform no simulation)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">years</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">years</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storage_conditions</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">storage_conditions</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assembled_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulate storage of DNA sequences in a storage medium.</span>

<span class="sd">        :param assembled_data: An object of class AssembledData.</span>
<span class="sd">        :return: A list of stored DNA sequences.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_conditions</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">years</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">stored_data</span> <span class="o">=</span> <span class="n">StoredData</span><span class="p">(</span><span class="n">assembled_data</span><span class="o">=</span><span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">strand_breaks</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_conditions</span> <span class="o">==</span> <span class="s1">&#39;random&#39;</span><span class="p">:</span>
            <span class="n">holder</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">oligo</span> <span class="ow">in</span> <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">oligo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">460</span><span class="p">)):</span>
                    <span class="n">bases</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">]</span>
                    <span class="n">randomposition</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">oligo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">randombase</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">bases</span><span class="p">)</span>
                    <span class="n">oligo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">oligo</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="n">randomposition</span><span class="p">]</span> <span class="o">+</span> <span class="n">randombase</span> <span class="o">+</span> <span class="n">oligo</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">randomposition</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
                <span class="n">holder</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">oligo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">oligo</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
                <span class="n">strand_breaks</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">oligo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">460</span><span class="p">)</span>

            <span class="n">stored_data</span> <span class="o">=</span> <span class="n">StoredData</span><span class="p">(</span><span class="n">assembled_data</span><span class="o">=</span><span class="n">holder</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">assembled_data</span><span class="p">,</span> <span class="n">AssembledData</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span>
                <span class="c1">#scaled_data = [item for item in data for _ in range(self.scale)]</span>
                <span class="n">remaining_oligos</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="c1">#for oligo in scaled_data:</span>

                <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="k">for</span> <span class="n">oligo</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>

                <span class="c1"># Probability of decay per oligo equals 1 minus the probability that not a single nucleotide decayed</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_conditions</span> <span class="o">==</span> <span class="s1">&#39;permafrost&#39;</span><span class="p">:</span>
                        <span class="n">decay_probability</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">5.5E-6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">oligo</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_conditions</span> <span class="o">==</span> <span class="s1">&#39;biogene&#39;</span><span class="p">:</span>
                        <span class="n">decay_probability</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">1E-7</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">oligo</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>

                    <span class="k">else</span><span class="p">:</span> 
                        <span class="n">decay_probability</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">5E-3</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">oligo</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>

                    <span class="n">rndm</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>

                    <span class="k">if</span> <span class="n">rndm</span> <span class="o">&gt;</span> <span class="n">decay_probability</span><span class="p">:</span>
                        <span class="n">remaining_oligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oligo</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="n">strand_breaks</span> <span class="o">=</span> <span class="n">counter</span>
                    <span class="c1"># Approach, where every oligo has an equal probability of decay</span>
                    <span class="c1"># N_t = len(data) * math.exp(-decay_probability * self.years)</span>
                    <span class="c1"># remaining_oligos = random.sample(data, int(round(N_t)))</span>

                <span class="n">stored_data</span> <span class="o">=</span> <span class="n">StoredData</span><span class="p">(</span><span class="n">assembled_data</span><span class="o">=</span><span class="n">remaining_oligos</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span> 
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The input data is not an instance of StoredData.&quot;</span><span class="p">)</span>

        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;number_of_strand_breaks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strand_breaks</span>

        <span class="k">return</span> <span class="n">stored_data</span><span class="p">,</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="dnabyte.storage.SimulateStorage.simulate" class="doc doc-heading">
            <code class=" language-python"><span class="n">simulate</span><span class="p">(</span><span class="n">assembled_data</span><span class="p">)</span></code>

<a href="#dnabyte.storage.SimulateStorage.simulate" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Simulate storage of DNA sequences in a storage medium.</p>
<p>:param assembled_data: An object of class AssembledData.
:return: A list of stored DNA sequences.</p>


            <details class="quote">
              <summary>Source code in <code>dnabyte/storage.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">assembled_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate storage of DNA sequences in a storage medium.</span>

<span class="sd">    :param assembled_data: An object of class AssembledData.</span>
<span class="sd">    :return: A list of stored DNA sequences.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_conditions</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">years</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">stored_data</span> <span class="o">=</span> <span class="n">StoredData</span><span class="p">(</span><span class="n">assembled_data</span><span class="o">=</span><span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">strand_breaks</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_conditions</span> <span class="o">==</span> <span class="s1">&#39;random&#39;</span><span class="p">:</span>
        <span class="n">holder</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">oligo</span> <span class="ow">in</span> <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">oligo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">460</span><span class="p">)):</span>
                <span class="n">bases</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">]</span>
                <span class="n">randomposition</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">oligo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">randombase</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">bases</span><span class="p">)</span>
                <span class="n">oligo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">oligo</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="n">randomposition</span><span class="p">]</span> <span class="o">+</span> <span class="n">randombase</span> <span class="o">+</span> <span class="n">oligo</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">randomposition</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">holder</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">oligo</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">oligo</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">strand_breaks</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">oligo</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mi">460</span><span class="p">)</span>

        <span class="n">stored_data</span> <span class="o">=</span> <span class="n">StoredData</span><span class="p">(</span><span class="n">assembled_data</span><span class="o">=</span><span class="n">holder</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">assembled_data</span><span class="p">,</span> <span class="n">AssembledData</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">assembled_data</span><span class="o">.</span><span class="n">data</span>
            <span class="c1">#scaled_data = [item for item in data for _ in range(self.scale)]</span>
            <span class="n">remaining_oligos</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1">#for oligo in scaled_data:</span>

            <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">for</span> <span class="n">oligo</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>

            <span class="c1"># Probability of decay per oligo equals 1 minus the probability that not a single nucleotide decayed</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_conditions</span> <span class="o">==</span> <span class="s1">&#39;permafrost&#39;</span><span class="p">:</span>
                    <span class="n">decay_probability</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">5.5E-6</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">oligo</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_conditions</span> <span class="o">==</span> <span class="s1">&#39;biogene&#39;</span><span class="p">:</span>
                    <span class="n">decay_probability</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">1E-7</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">oligo</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span> 
                    <span class="n">decay_probability</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">5E-3</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">oligo</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">years</span><span class="p">)</span>

                <span class="n">rndm</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">rndm</span> <span class="o">&gt;</span> <span class="n">decay_probability</span><span class="p">:</span>
                    <span class="n">remaining_oligos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">oligo</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="n">strand_breaks</span> <span class="o">=</span> <span class="n">counter</span>
                <span class="c1"># Approach, where every oligo has an equal probability of decay</span>
                <span class="c1"># N_t = len(data) * math.exp(-decay_probability * self.years)</span>
                <span class="c1"># remaining_oligos = random.sample(data, int(round(N_t)))</span>

            <span class="n">stored_data</span> <span class="o">=</span> <span class="n">StoredData</span><span class="p">(</span><span class="n">assembled_data</span><span class="o">=</span><span class="n">remaining_oligos</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span> 
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The input data is not an instance of StoredData.&quot;</span><span class="p">)</span>

    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;number_of_strand_breaks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">strand_breaks</span>

    <span class="k">return</span> <span class="n">stored_data</span><span class="p">,</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="dnabyte.sequencing"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="dnabyte.sequencing.SimulateSequencing" class="doc doc-heading">
            <code>SimulateSequencing</code>


<a href="#dnabyte.sequencing.SimulateSequencing" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Simulate sequencing of DNA sequences.
There are two main types of sequencing technologies: Illumina and Nanopore, each with their 
characteristic error profiles.</p>
<p>:param sequencing_technology: A string 'illumina', or 'nanopore'. None to perform no sequencing simulation.</p>







              <details class="quote">
                <summary>Source code in <code>dnabyte/sequencing.py</code></summary>
                <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SimulateSequencing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate sequencing of DNA sequences.</span>
<span class="sd">    There are two main types of sequencing technologies: Illumina and Nanopore, each with their </span>
<span class="sd">    characteristic error profiles.</span>

<span class="sd">    :param sequencing_technology: A string &#39;illumina&#39;, or &#39;nanopore&#39;. None to perform no sequencing simulation.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequencing_method</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">sequencing_method</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequencing_method</span> <span class="o">==</span> <span class="s1">&#39;iid&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iidmethod</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">iid_error_rate</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iidmethod</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simulate sequencing of DNA sequences.</span>

<span class="sd">        :param data: A list of DNA sequences.</span>
<span class="sd">        :return: A list of sequenced DNA sequences.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequencing_method</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sequenced_data</span> <span class="o">=</span> <span class="n">SequencedData</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">error_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">StoredData</span><span class="p">):</span>

                <span class="c1"># # Simulate sequencing errors</span>
                <span class="c1"># if self.sequencing_technology == &#39;illumina&#39;:</span>
                <span class="c1">#     sequenced_data = [self.simulate_illumina_sequencing(seq) for seq in data]</span>
                <span class="c1"># elif self.sequencing_technology == &#39;nanopore&#39;:</span>
                <span class="c1">#     sequenced_data = [self.simulate_nanopore_sequencing(seq) for seq in data]</span>
                <span class="c1"># else:</span>
                <span class="c1">#     raise ValueError(&quot;Sequencing technology not recognized.&quot;)</span>

                <span class="n">data_seq</span><span class="p">,</span> <span class="n">error_dict</span> <span class="o">=</span> <span class="n">sequencing_simulation</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">method_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sequencing_method</span><span class="p">,</span> <span class="n">errorrate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">iidmethod</span><span class="p">)</span>

                <span class="n">sequenced_data</span> <span class="o">=</span> <span class="n">SequencedData</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_seq</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The input data is not an instance of StoredData.&quot;</span><span class="p">)</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">info</span><span class="p">[</span><span class="s1">&#39;eror_dict&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">error_dict</span>

        <span class="k">return</span> <span class="n">sequenced_data</span><span class="p">,</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="dnabyte.sequencing.SimulateSequencing.simulate" class="doc doc-heading">
            <code class=" language-python"><span class="n">simulate</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

<a href="#dnabyte.sequencing.SimulateSequencing.simulate" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Simulate sequencing of DNA sequences.</p>
<p>:param data: A list of DNA sequences.
:return: A list of sequenced DNA sequences.</p>


            <details class="quote">
              <summary>Source code in <code>dnabyte/sequencing.py</code></summary>
              <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simulate sequencing of DNA sequences.</span>

<span class="sd">    :param data: A list of DNA sequences.</span>
<span class="sd">    :return: A list of sequenced DNA sequences.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequencing_method</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sequenced_data</span> <span class="o">=</span> <span class="n">SequencedData</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">error_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">StoredData</span><span class="p">):</span>

            <span class="c1"># # Simulate sequencing errors</span>
            <span class="c1"># if self.sequencing_technology == &#39;illumina&#39;:</span>
            <span class="c1">#     sequenced_data = [self.simulate_illumina_sequencing(seq) for seq in data]</span>
            <span class="c1"># elif self.sequencing_technology == &#39;nanopore&#39;:</span>
            <span class="c1">#     sequenced_data = [self.simulate_nanopore_sequencing(seq) for seq in data]</span>
            <span class="c1"># else:</span>
            <span class="c1">#     raise ValueError(&quot;Sequencing technology not recognized.&quot;)</span>

            <span class="n">data_seq</span><span class="p">,</span> <span class="n">error_dict</span> <span class="o">=</span> <span class="n">sequencing_simulation</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">method_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sequencing_method</span><span class="p">,</span> <span class="n">errorrate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">iidmethod</span><span class="p">)</span>

            <span class="n">sequenced_data</span> <span class="o">=</span> <span class="n">SequencedData</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data_seq</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The input data is not an instance of StoredData.&quot;</span><span class="p">)</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;eror_dict&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">error_dict</span>

    <span class="k">return</span> <span class="n">sequenced_data</span><span class="p">,</span> <span class="n">info</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Eko-Refugium" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/96306392/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["icons"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
    
  </body>
</html>